Notebook[{
Cell[BoxData["Exit"], "Input",
 CellLabel->
  "In[803]:=",ExpressionUUID->"393f702c-d189-41db-ad39-397907748435"],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<PM`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"LoadPackages", "[", "\"\<Geometries\>\"", "]"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"19f63c55-e1af-4e31-8663-058fa64a6723"],

Cell[BoxData[
 RowBox[{"EigentimeChart", "[", 
  RowBox[{"p", ",", "0."}], "]"}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"32a10564-eedd-46cd-9f32-042e25beaf91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pfile", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$HomeDirectory", ",", "\"\<Tools_Profile.tsv\>\""}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"ImportProfile", "[", "pfile", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Sunburst", "[", "p", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EigentimeTable", "[", 
  RowBox[{"p", ",", "2."}], "]"}]}], "Input",
 CellLabel->
  "In[363]:=",ExpressionUUID->"f28acdde-2d9d-4129-b53b-a257df058bd6"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"ce5e5f82-61c0-4202-bbb9-082d30f79c58"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"q", "=", "p"}], ";"}], 
  "*)"}]], "Input",ExpressionUUID->"8be8a252-e9c2-42f5-bfc4-a2221301971d"],

Cell[BoxData[{
 RowBox[{"Sunburst", "[", "q", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EigentimeTable", "[", 
  RowBox[{"q", ",", "0."}], "]"}]}], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"95fd1e4b-fdfa-4602-9fc3-8e1cdd602822"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"ed16abef-14e8-417a-9c85-272fdcfffdac"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"471c9d3a-9752-4e71-a1bd-eeb75857d21c"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"ca790839-9ff7-4871-b13d-72553bc9ecef"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"7c6cda70-ce04-42f1-8b10-acaaa7189b78"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"813114fd-803f-46a7-bfa1-8b71488823ee"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"e28fcee1-8d1c-4e7f-9e73-f6880d95b469"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"2b64c28b-f00f-4c34-b336-142b601451c4"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"2aeef6d1-a29d-4d0a-a8f7-fb9d3374ef2d"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"c662ba86-4320-4f07-805d-9f02eb4defe1"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"aaa6d883-3527-4c94-a80c-fa59be7f9a1e"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"f2944a6c-763f-4332-a39e-a9169fcfc3d2"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], \
"Input",ExpressionUUID->"310da545-ac56-47d4-a71c-5ac4aff7ce02"],

Cell[BoxData[{
 RowBox[{"sunburst", "=", 
  RowBox[{"Sunburst", "[", "p", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"table", "=", 
  RowBox[{"EigentimeTable", "[", 
   RowBox[{"p", ",", "2."}], "]"}]}]}], "Input",
 CellLabel->"In[93]:=",ExpressionUUID->"200d4373-0882-421e-adc8-7e38bef323bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", "\"\</Users/Henrik/Tools_Log.txt\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"StringSplit", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"file", ",", "\"\<Text\>\""}], "]"}], ",", "\"\<\\n\>\""}], 
      "]"}], ",", "\"\<\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startstr", "=", "\"\<started at\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endstr", "=", "\"\<ended   at\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"starts", "=", 
   RowBox[{"StringTrim", "/@", 
    RowBox[{"StringSplit", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"s", ",", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", "startstr"}], "]"}], "&"}]}], "]"}], ",", 
      "startstr"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ends", "=", 
    RowBox[{"StringTrim", "/@", 
     RowBox[{"StringSplit", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"s", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "endstr"}], "]"}], "&"}]}], "]"}], ",", 
       "endstr"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Counts", "[", 
    RowBox[{"starts", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", 
    RowBox[{"Counts", "[", 
     RowBox[{"ends", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Values", "@", 
  RowBox[{"Merge", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", "Differences"}], "]"}]}]}], "Input",
 
 CellLabel->
  "In[117]:=",ExpressionUUID->"8e5c3974-7c40-47f5-8a75-4f65cd5a313a"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"b4eaa4e1-570c-4a7b-aa43-02299e9e35f7"],

Cell[BoxData[{
 RowBox[{"Length", "[", "starts", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "ends", "]"}]}], "Input",
 CellLabel->
  "In[106]:=",ExpressionUUID->"3cf4b30e-e246-42e5-a56f-b932da634ae1"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"7549a6c0-e6ae-44db-b34d-5410bc4365f5"],

Cell[BoxData[
 RowBox[{"Merge", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", "Differences"}], "]"}]], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"733ef612-c343-41e2-99a4-64dfbcea76d4"],

Cell[BoxData[
 RowBox[{"Values", "@", 
  RowBox[{"Merge", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", "Differences"}], "]"}]}]], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"175ccf59-9a90-4153-bf0f-def3cc419532"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"M", "=", 
    RowBox[{"ToMesh", "@", 
     RowBox[{
     "Import", "[", 
      "\"\</Users/Henrik/ownCloud/triceratops_BAEMM_16inc_TPM0_8pi_remeshed_\
new_tau_3_rho_0.8/iteration_1.stl\>\"", "]"}]}]}], ";", "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Triceratops_\>\"", "<>", 
        RowBox[{"IntegerString", "[", 
         RowBox[{
          RowBox[{"SimplexCount", "[", "M", "]"}], ",", "10", ",", "8"}], 
         "]"}], "<>", "\"\<T.txt\>\""}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
      RowBox[{"\"\<dom_dim \>\"", ",", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"DomainDimension", "[", "M", "]"}], "]"}], ",", "\"\<\\n\>\"",
        ",", "\[IndentingNewLine]", "\"\<amb_dim \>\"", ",", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"EmbeddingDimension", "[", "M", "]"}], "]"}], ",", 
       "\"\<\\n\>\"", ",", "\[IndentingNewLine]", "\"\<vertex_count \>\"", 
       ",", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"VertexCount", "[", "M", "]"}], "]"}], ",", "\"\<\\n\>\"", 
       ",", "\[IndentingNewLine]", "\"\<simplex_count \>\"", ",", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"SimplexCount", "[", "M", "]"}], "]"}], ",", "\"\<\\n\>\"", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ExportString", "[", 
        RowBox[{
         RowBox[{"Threshold", "[", 
          RowBox[{
           RowBox[{"VertexCoordinates", "[", "M", "]"}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"-", "16"}]}]}], "]"}], ",", "\"\<Table\>\"", ",", 
         RowBox[{"\"\<FieldSeparators\>\"", "->", "\"\< \>\""}]}], "]"}], ",",
        "\[IndentingNewLine]", "\"\<\\n\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"ExportString", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Triangles", "[", "M", "]"}], "-", "1"}], ",", 
         "\"\<Table\>\"", ",", 
         RowBox[{"\"\<FieldSeparators\>\"", "->", "\"\< \>\""}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "*)"}]], "Input",ExpressionUUID->"27ba3d26-e7d5-4a8b-81f1-eb226fd80dc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"1073741824", "/", "64"}], "/", "32"}]], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"7f188466-5286-4b65-9996-8b31b74541b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\</Users/Henrik/Tools_Log.txt\>\"", ",", "\"\<Text\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rs", "=", 
   RowBox[{"rStrings", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{
    RowBox[{"ImportString", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"StringRiffle", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"StringTrim", "[", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{"rs", ",", 
               RowBox[{"7", ";;", 
                RowBox[{"-", "3"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<{\>\"", "->", "\"\<\>\""}], ",", 
               RowBox[{"\"\<}\>\"", "->", "\"\<\>\""}], ",", 
               RowBox[{"\"\<,\>\"", "->", "\"\<\>\""}]}], "}"}]}], "]"}], 
           ",", "\"\<\\n\>\""}], "]"}], "]"}], ",", "\"\<\\n\>\""}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      "\"\<CSV\>\""}], "\[IndentingNewLine]", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->
  "In[178]:=",ExpressionUUID->"b0b8d84e-34ac-4980-b4a4-a4a02c9c02d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"b", "=", "r"}], ";"}]], "Input",
 CellLabel->
  "In[181]:=",ExpressionUUID->"6f94851f-b807-475f-a626-9168637387ff"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"a", "=", "r"}], ";"}], 
  "*)"}]], "Input",ExpressionUUID->"33a8c6a5-dcc5-4cb4-82f4-2655960d0d26"],

Cell[BoxData[
 RowBox[{"StringCases", "[", 
  RowBox[{"s", ",", "\"\<r = {\>\""}], "]"}]], "Input",
 CellLabel->
  "In[103]:=",ExpressionUUID->"c56979c7-aab9-4df1-be3e-3a1740042bb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rStrings", "=", 
   RowBox[{"StringCases", "[", 
    RowBox[{"s", ",", 
     RowBox[{"Shortest", "[", 
      RowBox[{"\"\<r = {\>\"", "~~", "___", "~~", "\"\<}\n}\>\""}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[107]:=",ExpressionUUID->"13751a64-43c5-45e1-aaa0-6c1a0957c65e"],

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", 
   RowBox[{"a", "-", "b"}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[182]:=",ExpressionUUID->"00b0544a-de22-4ab6-9368-4252c15e2c8d"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"410b330c-ddb3-4bd5-8271-1bcf0b0312ee"],

Cell[BoxData["r"], "Input",
 CellLabel->
  "In[145]:=",ExpressionUUID->"f6789ab6-492d-4db0-92fa-75a031bd3e6f"],

Cell[BoxData[""], "Input",
 CellLabel->
  "In[112]:=",ExpressionUUID->"f2725c03-6e90-439e-8cfb-b69eda37ae64"],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{
   RowBox[{"rStrings", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"5", ";;"}]}], 
  "]"}]], "Input",ExpressionUUID->"8010b5df-088c-4502-9168-b8eadf07357e"],

Cell[BoxData[""], "Input",
 CellLabel->
  "In[129]:=",ExpressionUUID->"7daaab0e-82b3-41bd-bc23-9b333ccda6fe"],

Cell[BoxData[""], "Input",
 CellLabel->
  "In[130]:=",ExpressionUUID->"157e3cd8-8690-4dcf-af5d-e240115cb06b"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"9c22a87b-edbe-486b-965e-d1bc03d92adc"],

Cell[BoxData[
 RowBox[{"StringSplit", "[", 
  RowBox[{
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"StringTake", "[", 
      RowBox[{
       RowBox[{"rStrings", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"7", ";;", 
        RowBox[{"-", "3"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "->", "\"\<\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "->", "\"\<\>\""}], ",", 
       RowBox[{"\"\<,\>\"", "->", "\"\<\>\""}]}], "}"}]}], "]"}], ",", 
   "\"\<\\n\>\""}], "]"}]], "Input",
 CellLabel->
  "In[139]:=",ExpressionUUID->"90c9c89e-d39d-40af-8717-8d1da8fb7166"],

Cell[BoxData[""], "Input",
 CellLabel->
  "In[140]:=",ExpressionUUID->"15a2ee9b-0a52-4514-ad6d-ee93c84cc4bf"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"7ead0366-eeda-4e60-b5c0-44b4cf6cca44"],

Cell[BoxData[
 RowBox[{" ", 
  TemplateBox[<|"shortenedBoxes" -> TagBox[
      RowBox[{"{", 
        RowBox[{
         "0.0002156225382350385`", ",", "0.0002922012936323881`", ",", 
          "0.0001142116234404966`", ",", "0.0003498956211842597`", ",", 
          "0.00001602348493179306`", ",", "0.00001959990186151117`", ",", 
          "0.00003057251160498708`", ",", "0.00002755675814114511`", ",", 
          "0.0002128594205714762`", ",", 
          TemplateBox[{"28400"}, "OutputSizeLimit`Skeleton"], ",", 
          "0.00006448388012358919`", ",", "0.0000709147279849276`", ",", 
          "0.00007285508036147803`", ",", "0.00005989009878248908`", ",", 
          "0.00006279171066125855`", ",", "0.00006109711102908477`", ",", 
          "0.0000463208561995998`", ",", "0.00004522981544141658`", ",", 
          "0.00005542878352571279`"}], "}"}], Short[#, 8]& ], "line" -> 142, 
    "sessionID" -> 25244292384721439073, "byteCount" -> 227496, "size" -> 8, 
    "stored" -> False, "expr" -> Missing["NotStored"], "wrap" -> 
    OutputSizeLimit`Defer, "version" -> 1|>,
   "OutputSizeLimitTemplate"]}]], \
"Input",ExpressionUUID->"568dce1f-e919-490a-8d6a-9a0e998e274e"],

Cell[BoxData[
 RowBox[{"ImportString", "[", 
  RowBox[{
   RowBox[{"StringTake", "[", 
    RowBox[{
     RowBox[{"rStrings", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"5", ";;"}]}], "]"}], ",", "\"\<Table\>\""}], "]"}]], "Input",
 CellLabel->
  "In[114]:=",ExpressionUUID->"d15a30f6-0f65-4c79-8683-7032dd4d88b0"],

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{"s1", ",", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"#", ",", "\"\<r = \>\""}], "]"}], "&"}]}], "]"}]], "Input",
 CellLabel->"In[95]:=",ExpressionUUID->"6bdaac69-0123-4603-9a08-f36107021294"],

Cell[BoxData[
 RowBox[{"s1", "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellLabel->"In[93]:=",ExpressionUUID->"af43a8a2-7097-44b7-8120-6163f78e8cc2"],

Cell[BoxData["s1"], "Input",
 CellLabel->"In[94]:=",ExpressionUUID->"4ff435f5-0875-477d-b9bf-0ed5ed4de596"],

Cell[BoxData[
 RowBox[{"s1", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellLabel->"In[84]:=",ExpressionUUID->"0bfad3ce-f3d6-4382-b6ff-9c6ac6e90476"],

Cell[BoxData[
 RowBox[{"OpenSource", "@", "LumpedAreas"}]], "Input",
 CellLabel->
  "In[184]:=",ExpressionUUID->"2049b7dd-3700-486b-8c2b-7405192a673f"],

Cell[BoxData[
 RowBox[{"M", "=", 
  RowBox[{"TriceratopsMesh", "[", "2", "]"}]}]], "Input",
 CellLabel->"In[76]:=",ExpressionUUID->"f03d14a6-040b-404e-b219-a1f926f2b1dd"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"b9d53560-3060-453e-bb65-c5d3cc7b9f2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ainv", " ", "x"}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellLabel->"In[90]:=",ExpressionUUID->"f7151ee0-1ee2-4cc6-8f5b-26655ee1c7b7"],

Cell[BoxData[
 RowBox[{"M", "=", 
  RowBox[{"SphereMesh", "[", "9", "]"}]}]], "Input",
 CellLabel->
  "In[349]:=",ExpressionUUID->"2a7dfe10-cb23-439b-a992-214a37682561"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Mass", "[", "M", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ainv", "=", 
   RowBox[{"LumpedAreasInverse", "[", "M", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"x", "\[Function]", 
    RowBox[{"(", 
     RowBox[{"ainv", " ", "x"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"VertexCount", "[", "M", "]"}], ",", "eq"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"CGLinearSolve", "[", 
     RowBox[{"A", ",", "b", ",", 
      RowBox[{"\"\<Preconditioner\>\"", "->", "P"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"sol", "[", "\"\<Iterations\>\"", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->
  "In[350]:=",ExpressionUUID->"39b3b171-edcc-433a-a343-c28e13f4cdc3"],

Cell[BoxData[
 RowBox[{"Keys", "[", "psol", 
  "]"}]], "Input",ExpressionUUID->"a036eb14-2d98-44c9-aabe-caecaf59157b"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"de6d7008-ab39-4660-86ad-3f1ed83307d6"],

Cell[BoxData[
 RowBox[{"KeyDrop", "[", 
  RowBox[{"sol", ",", "\"\<Solution\>\""}], "]"}]], "Input",
 CellLabel->
  "In[300]:=",ExpressionUUID->"e5587212-c8eb-4be5-bd5c-959d90c3ed61"],

Cell[BoxData[
 RowBox[{"sol", "//", "Dataset"}]], "Input",
 CellLabel->
  "In[292]:=",ExpressionUUID->"a11782f7-e1ee-48b1-bc39-92c47ad2c692"],

Cell[BoxData[
 RowBox[{"sol", "[", "\"\<Iterations\>\"", "]"}]], "Input",
 CellLabel->
  "In[291]:=",ExpressionUUID->"c66e88c8-5edf-4b03-b317-aaf749b9a20d"],

Cell[BoxData["."], \
"Input",ExpressionUUID->"1275cd52-7d02-4128-898d-5354129f3280"],

Cell[BoxData["0.866682`"], \
"Input",ExpressionUUID->"21cd372f-eeef-457a-89c0-5e531297eed7"],

Cell[BoxData["0.2"], \
"Input",ExpressionUUID->"ee5c54d3-fb74-43a8-ac04-7225f0c3e87a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"VertexCount", "[", "M", "]"}], ",", "32"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"VertexCount", "[", "M", "]"}], ",", "32"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->
  "In[122]:=",ExpressionUUID->"976aee15-33f0-4d7b-8014-c24b759458cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"z", "=", 
    RowBox[{"A", ".", "x"}]}], ";"}], "//", 
  "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "=", 
    RowBox[{"P", ".", "x"}]}], ";"}], "//", "RepeatedTiming"}]}], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"d4365b3f-10d9-4d95-9828-6090ebaf1605"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"VertexCount", "[", "M", "]"}], ",", "32"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"LinearSolve", "[", 
     RowBox[{"A", ",", "b", ",", 
      RowBox[{"\"\<Method\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<Krylov\>\"", ",", 
         RowBox[{"\"\<Method\>\"", "->", "\"\<ConjugateGradient\>\""}], ",", 
         RowBox[{"\"\<Preconditioner\>\"", "->", "\"\<ILU0\>\""}]}], 
        "}"}]}]}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellLabel->
  "In[246]:=",ExpressionUUID->"1bfb68b2-8546-4d76-bf6b-8714af2041c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"LinearSolve", "[", 
     RowBox[{"A", ",", "b", ",", 
      RowBox[{"\"\<Method\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<Krylov\>\"", ",", 
         RowBox[{"\"\<Method\>\"", "->", "\"\<ConjugateGradient\>\""}], ",", 
         RowBox[{"\"\<Preconditioner\>\"", "->", "\"\<ILU0\>\""}]}], 
        "}"}]}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], \
"Input",ExpressionUUID->"d6736914-88b9-403b-b39a-86b426cb8585"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"4fd7f949-0012-449a-9b59-bc1578a2f6b0"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"4e86d368-81fd-418f-8b35-ab2dffc249ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"SphereMesh", "[", "5", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Mass", "[", "M", "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[145]:=",ExpressionUUID->"8ebe2c52-387b-4699-872a-aaeaed5cb358"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"LinearSolve", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "=", 
    RowBox[{"S", "[", 
     RowBox[{"UnitVector", "[", 
      RowBox[{
       RowBox[{"Length", "[", "A", "]"}], ",", "1", ",", 
       RowBox[{"WorkingPrecision", "->", "MachinePrecision"}]}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SetColorGradientContours", "[", 
     RowBox[{"M", ",", "100"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ColorGradient", "[", 
     RowBox[{"M", ",", 
      RowBox[{"Log", "[", 
       RowBox[{"Abs", "[", "v", "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetColorGradientContours", "[", 
   RowBox[{"M", ",", "0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColorGradient", "[", 
    RowBox[{"M", ",", "v"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"MeshPlot", "[", "M", "]"}]}], "Input",
 CellLabel->
  "In[167]:=",ExpressionUUID->"067a4a91-0015-46a4-bb9a-22016363e0e1"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"28914b3a-0d67-43ce-8b5f-fc9f4b598049"],

Cell[BoxData[""], "Input",
 CellLabel->
  "In[186]:=",ExpressionUUID->"514aa7ab-32c3-4cd3-9d2c-11e0e7de6693"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ring1", "=", 
   RowBox[{
    RowBox[{"A", "[", "\"\<AdjacencyLists\>\"", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ring2", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{
     RowBox[{"A", "[", "\"\<AdjacencyLists\>\"", "]"}], "[", 
     RowBox[{"[", "ring1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ring3", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{
     RowBox[{"A", "[", "\"\<AdjacencyLists\>\"", "]"}], "[", 
     RowBox[{"[", "ring2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ring4", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{
     RowBox[{"A", "[", "\"\<AdjacencyLists\>\"", "]"}], "[", 
     RowBox[{"[", "ring3", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ring5", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{
     RowBox[{"A", "[", "\"\<AdjacencyLists\>\"", "]"}], "[", 
     RowBox[{"[", "ring4", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellLabel->
  "In[215]:=",ExpressionUUID->"790763c9-2931-4bb7-9ae3-fa67e8266294"],

Cell[BoxData[{
 RowBox[{"v0", "=", 
  RowBox[{"v", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"v1", "=", 
  RowBox[{"v", "[", 
   RowBox[{"[", 
    RowBox[{"Complement", "[", 
     RowBox[{"ring2", ",", "ring1"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"v2", "=", 
  RowBox[{"v", "[", 
   RowBox[{"[", 
    RowBox[{"Complement", "[", 
     RowBox[{"ring3", ",", "ring2"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"v3", "=", 
  RowBox[{"v", "[", 
   RowBox[{"[", 
    RowBox[{"Complement", "[", 
     RowBox[{"ring4", ",", "ring3"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"v4", "=", 
  RowBox[{"v", "[", 
   RowBox[{"[", 
    RowBox[{"Complement", "[", 
     RowBox[{"ring5", ",", "ring4"}], "]"}], "]"}], "]"}]}]}], "Input",
 CellLabel->
  "In[225]:=",ExpressionUUID->"2d140b85-c99a-4d28-9fb0-cc4abe9881d8"],

Cell[BoxData[{
 RowBox[{"Mean", "[", "v1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Mean", "[", "v2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Mean", "[", "v3", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Mean", "[", "v4", "]"}]}], "Input",
 CellLabel->
  "In[236]:=",ExpressionUUID->"056abed5-0f73-4643-82a5-dda85ceedcab"],

Cell[BoxData[
 RowBox[{"v", "[", 
  RowBox[{"[", "idx", "]"}], "]"}]], "Input",
 CellLabel->
  "In[181]:=",ExpressionUUID->"4b49466c-371d-4561-9c67-6fdb989db346"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AdjacencyLists", "[", "A", "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellLabel->
  "In[178]:=",ExpressionUUID->"07a1eb6f-df09-4691-baf2-c2b866f779dc"],

Cell[BoxData["v"], "Input",
 CellLabel->
  "In[172]:=",ExpressionUUID->"bb6c9e46-205c-4670-a702-0a76f9869ee5"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"3cf51c8e-74b0-4308-bd2d-da0aa0d11471"],

Cell[BoxData[
 RowBox[{"sol", "//", "Dataset"}]], "Input",
 CellLabel->"In[96]:=",ExpressionUUID->"80c56bf9-e3d0-42e1-817c-dc77769bda59"],

Cell[BoxData[
 RowBox[{"OpenSource", "@", "CGLinearSolve"}]], "Input",
 CellLabel->"In[88]:=",ExpressionUUID->"3e4446e7-76f1-4c68-973e-b8011587fe28"],

Cell[BoxData[
 RowBox[{"0.2", "/", 
  RowBox[{"(", 
   RowBox[{"1", "-", "0.2"}], ")"}]}]], "Input",
 CellLabel->"In[358]:=",ExpressionUUID->"de3c96c0-d444-4c8f-9014-797de494a60d"]
},
WindowSize->{1496, 905},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"01fa7f42-6e65-45e0-b48f-6b5addd12149"
]


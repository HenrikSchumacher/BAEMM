(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    101146,       2294]
NotebookOptionsPosition[     96406,       2214]
NotebookOutlinePosition[     96843,       2231]
CellTagsIndexPosition[     96800,       2228]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["Exit"], "Input",
 CellChangeTimes->{{3.88570689005732*^9, 3.885706890707129*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"8e9841d1-967c-428e-a87e-d627e936d29d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<Rubi`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<PM`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"LoadPackages", "[", "\"\<Geometries\>\"", "]"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"251f24c4-12bb-4590-911e-8382ba6eb591"],

Cell[CellGroupData[{

Cell[BoxData["\<\"WARNING: LTemplate has not yet been tested with Mathematica \
13.2.1.\\nThe latest supported Mathematica version is 12.3.1.\\nPlease report \
any issues you find to szhorvat at gmail.com.\"\>"], "Print",
 CellChangeTimes->{3.88631134302629*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"7686ce3d-96e2-4aab-bad0-1b50b555fe32"],

Cell[BoxData["\<\"\"\>"], "Print",
 CellChangeTimes->{3.8863113442323513`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"a9796e07-e57a-46a7-9af2-73eb85314eb0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "x", ",", "y", ",", "A", ",", "B", ",", "X", ",", "Y", ",", "CC", ",", 
     "f", ",", "t", ",", "r", ",", "\[Alpha]", ",", "\[Beta]", ",", 
     "L\[Alpha]", ",", "L\[Beta]", ",", "R", ",", "\[Kappa]", ",", "m", ",", 
     "h"}], "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Y", "=", 
    RowBox[{"Array", "[", 
     RowBox[{"y", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Y", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "c"}], "}"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"t", "=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{"Dot", "[", 
    RowBox[{
     RowBox[{"X", "-", "Y"}], ",", 
     RowBox[{"X", "-", "Y"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Nu]", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]", "=", 
    RowBox[{"Array", "[", 
     RowBox[{"m", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"single", " ", "layer"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"f", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "\[Kappa]", " ", "t"}], "]"}], "/", "t"}], "]"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"double", " ", "layer"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", "\[Kappa]", " ", "t"}], "]"}], "/", "t"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "1"}], "}"}]}], "]"}], ".", "\[Nu]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"adjoint", " ", "double", " ", "layer"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Don", "'"}], "t", " ", "do", " ", 
    RowBox[{"that", ".", " ", "Use"}], " ", "the", " ", "same", " ", 
    "formula", " ", "as", " ", "above", " ", "with", " ", "x", " ", "and", 
    " ", "y", " ", 
    RowBox[{"swapped", "!"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"f", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "\[Kappa]", " ", "t"}], "]"}], "/", "t"}], ",", 
         RowBox[{"{", 
          RowBox[{"X", ",", "1"}], "}"}]}], "]"}], ".", "\[Mu]"}], "]"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y", "[", "1", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y", "[", "2", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y", "[", "3", "]"}], "=", "c"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "1", "]"}], "=", 
   RowBox[{"r", " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "2", "]"}], "=", 
   RowBox[{"r", " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "3", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"Simplify", "[", "f", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"fR", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"f", "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"c", "^", "2"}], "+", 
       RowBox[{"r", "^", "2"}]}], "->", 
      RowBox[{"R", "^", "2"}]}]}], ",", 
    RowBox[{"R", ">", "0"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fRProxy", "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{"fR", ",", 
     RowBox[{"{", 
      RowBox[{"R", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fLrProxy", "=", 
   RowBox[{"fRProxy", "/.", 
    RowBox[{"R", "->", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"c", "^", "2"}], "+", 
       RowBox[{"r", "^", "2"}]}], "]"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intfr", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Int", "[", 
      RowBox[{
       RowBox[{"fLrProxy", " ", "r"}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "0", ",", 
         RowBox[{"L\[Beta]", " ", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Beta]", "]"}], "/", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "\[Element]", "Reals"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Pi"}], "/", "2"}], "<", "\[Phi]", "<", 
        RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"singularPart", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Int", "[", 
       RowBox[{"intfr", ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]", ",", "0", ",", "\[Beta]"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "\[Element]", "Reals"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Pi"}], "/", "2"}], "<", "\[Beta]", "<", 
         RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"singularPart", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"singularPart", "-", 
      RowBox[{"(", 
       RowBox[{"singularPart", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Beta]", "->", "\[Alpha]"}], ",", 
          RowBox[{"L\[Beta]", "->", "L\[Alpha]"}]}], "}"}]}], ")"}]}], "]"}], 
    "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], "->", 
       RowBox[{"h", "/", "L\[Alpha]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Beta]", "]"}], "->", 
       RowBox[{"h", "/", "L\[Beta]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox["c", "2"], "+", 
          SuperscriptBox["L\[Alpha]", "2"]}], "]"}]}], "->", 
       RowBox[{"1", "/", "R\[Alpha]"}]}], ",", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox["c", "2"], "+", 
          SuperscriptBox["L\[Beta]", "2"]}], "]"}]}], "->", 
       RowBox[{"1", "/", "R\[Beta]"}]}]}], "\[IndentingNewLine]", "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Alpha]", "]"}], "->", 
      RowBox[{"a", "/", "L\[Alpha]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Beta]", "]"}], "->", 
      RowBox[{"b", "/", "L\[Beta]"}]}], ",", 
     RowBox[{
      RowBox[{"Tan", "[", "\[Alpha]", "]"}], "->", 
      RowBox[{"a", "/", "h"}]}], ",", 
     RowBox[{
      RowBox[{"Tan", "[", "\[Beta]", "]"}], "->", 
      RowBox[{"b", "/", "h"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"regularPart", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"fR", "-", "fRProxy"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.885715915794334*^9, 3.885715930207285*^9}, {
   3.885789087583082*^9, 3.885789092942399*^9}, {3.885791279464241*^9, 
   3.885791289054247*^9}, {3.885793049863534*^9, 3.885793050126891*^9}, {
   3.885794044473584*^9, 3.88579404477597*^9}, {3.885795029820553*^9, 
   3.8857950304104633`*^9}, {3.885797025697688*^9, 3.8857970327465153`*^9}, 
   3.885797126423087*^9, 3.885798003628563*^9, {3.885799264085401*^9, 
   3.885799280675269*^9}, {3.885799859115868*^9, 3.885799945998987*^9}, {
   3.8858193652844753`*^9, 3.885819366780127*^9}, {3.885819430026457*^9, 
   3.88581944084385*^9}, {3.885960289747259*^9, 3.8859602948059464`*^9}, {
   3.8859610438255043`*^9, 3.885961044958358*^9}, {3.8862429194787416`*^9, 
   3.886242920470106*^9}, {3.886311107705448*^9, 3.8863111096755543`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"2189367f-cd50-4131-852a-b3dfd549e6ad"],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "[", "1", "]"}], "-", 
      RowBox[{"y", "[", "1", "]"}]}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "[", "2", "]"}], "-", 
      RowBox[{"y", "[", "2", "]"}]}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "[", "3", "]"}], "-", 
      RowBox[{"y", "[", "3", "]"}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.8857159017201157`*^9, 3.8857159305219803`*^9}, {
   3.885787220937504*^9, 3.885787243009219*^9}, 3.88578836192262*^9, 
   3.885788919941831*^9, 3.8857891032519627`*^9, {3.88579128643906*^9, 
   3.885791290276824*^9}, 3.885793050527596*^9, 3.8857940521682253`*^9, {
   3.885795019629751*^9, 3.885795030929501*^9}, 3.885795319788488*^9, {
   3.885796991530464*^9, 3.88579700054261*^9}, 3.885797033255172*^9, {
   3.885797113629014*^9, 3.885797126828929*^9}, 3.885797294041316*^9, {
   3.8857979991451674`*^9, 3.885798008358233*^9}, {3.885799164063648*^9, 
   3.885799168746707*^9}, {3.885799268764982*^9, 3.885799281593281*^9}, {
   3.885799868785286*^9, 3.8857999172872066`*^9}, 3.8857999475938587`*^9, 
   3.885817504234818*^9, 3.885817535717168*^9, 3.8858193671705217`*^9, {
   3.885819430345125*^9, 3.88581944111978*^9}, 3.885819873618627*^9, 
   3.885820086242907*^9, 3.8858201705453167`*^9, 3.885820289194749*^9, 
   3.885820580920417*^9, 3.8858206447036543`*^9, 3.885820710189727*^9, 
   3.885955464885234*^9, 3.88596029617301*^9, 3.885961045389708*^9, 
   3.886242841755715*^9, 3.886242920808967*^9, 3.886243186782806*^9, 
   3.8863113457709627`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"9809f420-e595-4cda-ae22-bd3aef2917f2"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["c", "2"], "+", 
       SuperscriptBox["r", "2"]}]], " ", "\[Kappa]"}]], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["c", "2"], "+", 
        SuperscriptBox["r", "2"]}]], " ", "\[Kappa]"}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["c", "2"], "+", 
     SuperscriptBox["r", "2"]}], ")"}], 
   RowBox[{"3", "/", "2"}]]]], "Output",
 CellChangeTimes->{{3.8857159017201157`*^9, 3.8857159305219803`*^9}, {
   3.885787220937504*^9, 3.885787243009219*^9}, 3.88578836192262*^9, 
   3.885788919941831*^9, 3.8857891032519627`*^9, {3.88579128643906*^9, 
   3.885791290276824*^9}, 3.885793050527596*^9, 3.8857940521682253`*^9, {
   3.885795019629751*^9, 3.885795030929501*^9}, 3.885795319788488*^9, {
   3.885796991530464*^9, 3.88579700054261*^9}, 3.885797033255172*^9, {
   3.885797113629014*^9, 3.885797126828929*^9}, 3.885797294041316*^9, {
   3.8857979991451674`*^9, 3.885798008358233*^9}, {3.885799164063648*^9, 
   3.885799168746707*^9}, {3.885799268764982*^9, 3.885799281593281*^9}, {
   3.885799868785286*^9, 3.8857999172872066`*^9}, 3.8857999475938587`*^9, 
   3.885817504234818*^9, 3.885817535717168*^9, 3.8858193671705217`*^9, {
   3.885819430345125*^9, 3.88581944111978*^9}, 3.885819873618627*^9, 
   3.885820086242907*^9, 3.8858201705453167`*^9, 3.885820289194749*^9, 
   3.885820580920417*^9, 3.8858206447036543`*^9, 3.885820710189727*^9, 
   3.885955464885234*^9, 3.88596029617301*^9, 3.885961045389708*^9, 
   3.886242841755715*^9, 3.886242920808967*^9, 3.886243186782806*^9, 
   3.886311345824923*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"7562661d-b354-4464-923d-618b835d1e51"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "R", " ", "\[Kappa]"}]], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"\[ImaginaryI]", " ", "R", " ", "\[Kappa]"}]}], ")"}]}], 
  SuperscriptBox["R", "3"]]], "Output",
 CellChangeTimes->{{3.8857159017201157`*^9, 3.8857159305219803`*^9}, {
   3.885787220937504*^9, 3.885787243009219*^9}, 3.88578836192262*^9, 
   3.885788919941831*^9, 3.8857891032519627`*^9, {3.88579128643906*^9, 
   3.885791290276824*^9}, 3.885793050527596*^9, 3.8857940521682253`*^9, {
   3.885795019629751*^9, 3.885795030929501*^9}, 3.885795319788488*^9, {
   3.885796991530464*^9, 3.88579700054261*^9}, 3.885797033255172*^9, {
   3.885797113629014*^9, 3.885797126828929*^9}, 3.885797294041316*^9, {
   3.8857979991451674`*^9, 3.885798008358233*^9}, {3.885799164063648*^9, 
   3.885799168746707*^9}, {3.885799268764982*^9, 3.885799281593281*^9}, {
   3.885799868785286*^9, 3.8857999172872066`*^9}, 3.8857999475938587`*^9, 
   3.885817504234818*^9, 3.885817535717168*^9, 3.8858193671705217`*^9, {
   3.885819430345125*^9, 3.88581944111978*^9}, 3.885819873618627*^9, 
   3.885820086242907*^9, 3.8858201705453167`*^9, 3.885820289194749*^9, 
   3.885820580920417*^9, 3.8858206447036543`*^9, 3.885820710189727*^9, 
   3.885955464885234*^9, 3.88596029617301*^9, 3.885961045389708*^9, 
   3.886242841755715*^9, 3.886242920808967*^9, 3.886243186782806*^9, 
   3.88631134587118*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"06cde29a-1343-4733-9c3c-f26fc27389c5"],

Cell[BoxData[
 RowBox[{
  FractionBox["c", 
   SuperscriptBox["R", "3"]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox["\[Kappa]", "2"]}], 
   RowBox[{"2", " ", "R"}]]}]], "Output",
 CellChangeTimes->{{3.8857159017201157`*^9, 3.8857159305219803`*^9}, {
   3.885787220937504*^9, 3.885787243009219*^9}, 3.88578836192262*^9, 
   3.885788919941831*^9, 3.8857891032519627`*^9, {3.88579128643906*^9, 
   3.885791290276824*^9}, 3.885793050527596*^9, 3.8857940521682253`*^9, {
   3.885795019629751*^9, 3.885795030929501*^9}, 3.885795319788488*^9, {
   3.885796991530464*^9, 3.88579700054261*^9}, 3.885797033255172*^9, {
   3.885797113629014*^9, 3.885797126828929*^9}, 3.885797294041316*^9, {
   3.8857979991451674`*^9, 3.885798008358233*^9}, {3.885799164063648*^9, 
   3.885799168746707*^9}, {3.885799268764982*^9, 3.885799281593281*^9}, {
   3.885799868785286*^9, 3.8857999172872066`*^9}, 3.8857999475938587`*^9, 
   3.885817504234818*^9, 3.885817535717168*^9, 3.8858193671705217`*^9, {
   3.885819430345125*^9, 3.88581944111978*^9}, 3.885819873618627*^9, 
   3.885820086242907*^9, 3.8858201705453167`*^9, 3.885820289194749*^9, 
   3.885820580920417*^9, 3.8858206447036543`*^9, 3.885820710189727*^9, 
   3.885955464885234*^9, 3.88596029617301*^9, 3.885961045389708*^9, 
   3.886242841755715*^9, 3.886242920808967*^9, 3.886243186782806*^9, 
   3.886311345882655*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"d74ec528-dd15-4f7d-97d1-5169f5af2d4f"],

Cell[BoxData[
 RowBox[{
  FractionBox["c", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["c", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox["\[Kappa]", "2"]}], 
   RowBox[{"2", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["c", "2"], "+", 
      SuperscriptBox["r", "2"]}]]}]]}]], "Output",
 CellChangeTimes->{{3.8857159017201157`*^9, 3.8857159305219803`*^9}, {
   3.885787220937504*^9, 3.885787243009219*^9}, 3.88578836192262*^9, 
   3.885788919941831*^9, 3.8857891032519627`*^9, {3.88579128643906*^9, 
   3.885791290276824*^9}, 3.885793050527596*^9, 3.8857940521682253`*^9, {
   3.885795019629751*^9, 3.885795030929501*^9}, 3.885795319788488*^9, {
   3.885796991530464*^9, 3.88579700054261*^9}, 3.885797033255172*^9, {
   3.885797113629014*^9, 3.885797126828929*^9}, 3.885797294041316*^9, {
   3.8857979991451674`*^9, 3.885798008358233*^9}, {3.885799164063648*^9, 
   3.885799168746707*^9}, {3.885799268764982*^9, 3.885799281593281*^9}, {
   3.885799868785286*^9, 3.8857999172872066`*^9}, 3.8857999475938587`*^9, 
   3.885817504234818*^9, 3.885817535717168*^9, 3.8858193671705217`*^9, {
   3.885819430345125*^9, 3.88581944111978*^9}, 3.885819873618627*^9, 
   3.885820086242907*^9, 3.8858201705453167`*^9, 3.885820289194749*^9, 
   3.885820580920417*^9, 3.8858206447036543`*^9, 3.885820710189727*^9, 
   3.885955464885234*^9, 3.88596029617301*^9, 3.885961045389708*^9, 
   3.886242841755715*^9, 3.886242920808967*^9, 3.886243186782806*^9, 
   3.886311345883945*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"7566955b-0f7b-458c-a7e6-8f68efddfae5"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{"\[Alpha]", "-", "\[Beta]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       SuperscriptBox["\[Kappa]", "2"]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"Abs", "[", "c", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{
            SuperscriptBox["c", "2"], " ", 
            SuperscriptBox["\[Kappa]", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ArcTan", "[", 
            FractionBox[
             RowBox[{"a", " ", "c"}], 
             RowBox[{"h", " ", "R\[Alpha]"}]], "]"}], "-", 
           RowBox[{"ArcTan", "[", 
            FractionBox[
             RowBox[{"b", " ", "c"}], 
             RowBox[{"h", " ", "R\[Beta]"}]], "]"}]}], ")"}]}], ")"}]}], "-", 
      
      RowBox[{"c", " ", "h", " ", 
       SuperscriptBox["\[Kappa]", "2"], " ", 
       RowBox[{"ArcTanh", "[", 
        FractionBox["a", "R\[Alpha]"], "]"}]}], "+", 
      RowBox[{"c", " ", "h", " ", 
       SuperscriptBox["\[Kappa]", "2"], " ", 
       RowBox[{"ArcTanh", "[", 
        FractionBox["b", "R\[Beta]"], "]"}]}]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"Abs", "[", "c", "]"}]}]]], "Output",
 CellChangeTimes->{{3.8857159017201157`*^9, 3.8857159305219803`*^9}, {
   3.885787220937504*^9, 3.885787243009219*^9}, 3.88578836192262*^9, 
   3.885788919941831*^9, 3.8857891032519627`*^9, {3.88579128643906*^9, 
   3.885791290276824*^9}, 3.885793050527596*^9, 3.8857940521682253`*^9, {
   3.885795019629751*^9, 3.885795030929501*^9}, 3.885795319788488*^9, {
   3.885796991530464*^9, 3.88579700054261*^9}, 3.885797033255172*^9, {
   3.885797113629014*^9, 3.885797126828929*^9}, 3.885797294041316*^9, {
   3.8857979991451674`*^9, 3.885798008358233*^9}, {3.885799164063648*^9, 
   3.885799168746707*^9}, {3.885799268764982*^9, 3.885799281593281*^9}, {
   3.885799868785286*^9, 3.8857999172872066`*^9}, 3.8857999475938587`*^9, 
   3.885817504234818*^9, 3.885817535717168*^9, 3.8858193671705217`*^9, {
   3.885819430345125*^9, 3.88581944111978*^9}, 3.885819873618627*^9, 
   3.885820086242907*^9, 3.8858201705453167`*^9, 3.885820289194749*^9, 
   3.885820580920417*^9, 3.8858206447036543`*^9, 3.885820710189727*^9, 
   3.885955464885234*^9, 3.88596029617301*^9, 3.885961045389708*^9, 
   3.886242841755715*^9, 3.886242920808967*^9, 3.886243186782806*^9, 
   3.886311347577867*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"f2a76f64-d339-41a7-9e4d-21734df9de50"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{
       SuperscriptBox["R", "2"], " ", 
       SuperscriptBox["\[Kappa]", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "R", " ", "\[Kappa]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "R", " ", "\[Kappa]"}]}], 
        ")"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["R", "3"]}]]}]], "Output",
 CellChangeTimes->{{3.8857159017201157`*^9, 3.8857159305219803`*^9}, {
   3.885787220937504*^9, 3.885787243009219*^9}, 3.88578836192262*^9, 
   3.885788919941831*^9, 3.8857891032519627`*^9, {3.88579128643906*^9, 
   3.885791290276824*^9}, 3.885793050527596*^9, 3.8857940521682253`*^9, {
   3.885795019629751*^9, 3.885795030929501*^9}, 3.885795319788488*^9, {
   3.885796991530464*^9, 3.88579700054261*^9}, 3.885797033255172*^9, {
   3.885797113629014*^9, 3.885797126828929*^9}, 3.885797294041316*^9, {
   3.8857979991451674`*^9, 3.885798008358233*^9}, {3.885799164063648*^9, 
   3.885799168746707*^9}, {3.885799268764982*^9, 3.885799281593281*^9}, {
   3.885799868785286*^9, 3.8857999172872066`*^9}, 3.8857999475938587`*^9, 
   3.885817504234818*^9, 3.885817535717168*^9, 3.8858193671705217`*^9, {
   3.885819430345125*^9, 3.88581944111978*^9}, 3.885819873618627*^9, 
   3.885820086242907*^9, 3.8858201705453167`*^9, 3.885820289194749*^9, 
   3.885820580920417*^9, 3.8858206447036543`*^9, 3.885820710189727*^9, 
   3.885955464885234*^9, 3.88596029617301*^9, 3.885961045389708*^9, 
   3.886242841755715*^9, 3.886242920808967*^9, 3.886243186782806*^9, 
   3.8863113475881977`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"33994fb9-0c1c-45d1-834f-dc376a9b8ad3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["f"], "Input",
 CellChangeTimes->{3.885820301411625*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"aa3eb0da-8063-4849-bedb-2d96d2e47e12"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["c", "2"], "+", 
       SuperscriptBox["r", "2"]}]], " ", "\[Kappa]"}]], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["c", "2"], "+", 
        SuperscriptBox["r", "2"]}]], " ", "\[Kappa]"}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["c", "2"], "+", 
     SuperscriptBox["r", "2"]}], ")"}], 
   RowBox[{"3", "/", "2"}]]]], "Output",
 CellChangeTimes->{3.8858203018937073`*^9, 3.8862429223586617`*^9, 
  3.88624318844599*^9, 3.886311347643862*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"638c65af-5c3e-4421-af0c-08d452f75ca0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DoubleLayerSingularPart", "[", 
    RowBox[{
     RowBox[{"y_", "?", "VectorQ"}], ",", 
     RowBox[{"T_", "?", "MatrixQ"}], ",", "\[Kappa]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Nu]", ",", "h", ",", "factor1", ",", "factor2", ",", "a3OverR1", ",",
        "b3OverR2", ",", "a1OverR2", ",", "b1OverR3", ",", "a2OverR3", ",", 
       "b2OverR1", ",", "anglesum", ",", "cOverh1", ",", "cOverh2", ",", 
       "cOverh3", ",", "\[IndentingNewLine]", "R1R1", ",", "R2R2", ",", 
       "R3R3", ",", "R1inv", ",", "R2inv", ",", "R3inv", ",", "L1inv", ",", 
       "L2inv", ",", "L3inv", ",", "x1", ",", "x2", ",", "x3", ",", "v1", ",",
        "v2", ",", "v3", ",", "w1", ",", "w2", ",", "w3", ",", "Z1", ",", 
       "Z2", ",", "Z3", ",", "h1", ",", "h2", ",", "h3", ",", "h1inv", ",", 
       "h2inv", ",", "h3inv", ",", "a1", ",", "a2", ",", "a3", ",", "b1", ",",
        "b2", ",", "b3", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Alpha]3",
        ",", "\[Beta]1", ",", "\[Beta]2", ",", "\[Beta]3"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"WLOG", ":", " ", "y"}], " ", "=", " ", "0"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "y"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x2", "=", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", "y"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x3", "=", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "-", "y"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "v_i", " ", "is", " ", "the", " ", "vector", " ", "pointing", " ", 
        "in", " ", "direction", " ", "of", " ", "the", " ", "line", " ", "of",
         " ", "the", " ", 
        RowBox[{"triangle", "'"}], "s", " ", "edge", " ", "opposing", " ", 
        "x_i"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"x3", "-", "x2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"x1", "-", "x3"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v3", "=", 
       RowBox[{"x2", "-", "x1"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{"Normalize", "[", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"x2", "-", "x1"}], ",", 
          RowBox[{"x3", "-", "x1"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"h", "=", 
       RowBox[{"-", 
        RowBox[{"Dot", "[", 
         RowBox[{"x1", ",", "\[Nu]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"F", " ", "=", " ", 
         RowBox[{
         "projection", " ", "of", " ", "Y", " ", "into", " ", "plane", " ", 
          "of", " ", "x1"}]}], ",", " ", "x2", ",", " ", 
        RowBox[{"x3", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"but", " ", "we", " ", 
            RowBox[{"don", "'"}], "t", " ", "need", " ", "it"}], ")"}], 
          "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"F", "=", 
         RowBox[{
          RowBox[{"-", "\[Nu]"}], " ", "h"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Z_i", " ", "is", " ", "the", " ", "projection", " ", "of", " ", "F", 
        " ", "onto", " ", "the", " ", "line", " ", "of", " ", "the", " ", 
        RowBox[{"triangle", "'"}], "s", " ", "edge", " ", "opposing", " ", 
        "x_i"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Z1", "=", 
         RowBox[{"x2", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"x2", "-", "F"}], ",", "v1"}], "]"}], "/", 
             RowBox[{"Dot", "[", 
              RowBox[{"v1", ",", "v1"}], "]"}]}], ")"}], " ", "v1"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Z2", "=", 
         RowBox[{"x3", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"x3", "-", 
                RowBox[{"Abs", "[", "h", "]"}]}], ",", "v2"}], "]"}], "/", 
             RowBox[{"Dot", "[", 
              RowBox[{"v2", ",", "v2"}], "]"}]}], ")"}], " ", "v2"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Z3", "=", 
         RowBox[{"x1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"x1", "-", "F"}], ",", "v3"}], "]"}], "/", 
             RowBox[{"Dot", "[", 
              RowBox[{"v3", ",", "v3"}], "]"}]}], ")"}], " ", "v3"}]}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Since", " ", "Y"}], " ", "==", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
        RowBox[{
         RowBox[{"and", " ", "since", " ", "Y"}], "-", 
         RowBox[{
         "F", " ", "is", " ", "perpendicular", " ", "to", " ", "v_i"}]}], ",",
         " ", 
        RowBox[{"we", " ", "may", " ", "do", " ", "this", " ", 
         RowBox[{"instead", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Z1", "=", 
       RowBox[{"x2", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{"x2", ",", "v1"}], "]"}], "/", 
           RowBox[{"Dot", "[", 
            RowBox[{"v1", ",", "v1"}], "]"}]}], ")"}], " ", "v1"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Z2", "=", 
       RowBox[{"x3", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{"x3", ",", "v2"}], "]"}], "/", 
           RowBox[{"Dot", "[", 
            RowBox[{"v2", ",", "v2"}], "]"}]}], ")"}], " ", "v2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Z3", "=", 
       RowBox[{"x1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{"x1", ",", "v3"}], "]"}], "/", 
           RowBox[{"Dot", "[", 
            RowBox[{"v3", ",", "v3"}], "]"}]}], ")"}], " ", "v3"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"w_i", "==", 
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"F", "-", "Z_i"}], ",", "\[Nu]"}], "]"}], " ", "is", " ", 
         "the", " ", "height", " ", "vector", " ", "rotated", " ", "by", " ", 
         "90", " ", "degrees"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"w1", "=", 
       RowBox[{"Cross", "[", 
        RowBox[{"\[Nu]", ",", "Z1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w2", "=", 
       RowBox[{"Cross", "[", 
        RowBox[{"\[Nu]", ",", "Z2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w3", "=", 
       RowBox[{"Cross", "[", 
        RowBox[{"\[Nu]", ",", "Z3"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"h1", "=", 
       RowBox[{"Norm", "[", "w1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"h2", "=", 
       RowBox[{"Norm", "[", "w2", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"h3", "=", 
       RowBox[{"Norm", "[", "w3", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"h1inv", "=", 
       RowBox[{"1.", "/", "h1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"h2inv", "=", 
       RowBox[{"1.", "/", "h2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"h3inv", "=", 
       RowBox[{"1.", "/", "h3"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"a1", "=", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"w1", ",", 
            RowBox[{"x2", "-", "Z1"}]}], "]"}], " ", "h1inv"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a2", "=", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"w2", ",", 
            RowBox[{"x3", "-", "Z2"}]}], "]"}], "h2inv"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a3", "=", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"w3", ",", 
            RowBox[{"x1", "-", "Z3"}]}], "]"}], "h3inv"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"b1", "=", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"w1", ",", 
            RowBox[{"x3", "-", "Z1"}]}], "]"}], "h1inv"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"b2", "=", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"w2", ",", 
            RowBox[{"x1", "-", "Z2"}]}], "]"}], "h2inv"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"b3", "=", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"w3", ",", 
            RowBox[{"x2", "-", "Z3"}]}], "]"}], "h3inv"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Since", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"w_", "1"}], ",", 
             RowBox[{"Z_", "1"}]}], "]"}], ",", 
           RowBox[{"Z_", "1"}]}], "]"}]}], " ", "==", " ", 
        RowBox[{"0", " ", "we", " ", "may", " ", "simplify", " ", "as", " ", 
         RowBox[{"follows", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"a1", "=", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"w1", ",", "x2"}], "]"}], " ", "h1inv"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a2", "=", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"w2", ",", "x3"}], "]"}], "h2inv"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a3", "=", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"w3", ",", "x1"}], "]"}], "h3inv"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"b1", "=", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"w1", ",", "x3"}], "]"}], "h1inv"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b2", "=", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"w2", ",", "x1"}], "]"}], "h2inv"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b3", "=", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"w3", ",", "x2"}], "]"}], "h3inv"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"anglesum", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sign", "[", 
           RowBox[{"b1", "-", "a1"}], "]"}], "==", 
          RowBox[{"Sign", "[", 
           RowBox[{"b2", "-", "a2"}], "]"}], "==", 
          RowBox[{"Sign", "[", 
           RowBox[{"b3", "-", "a3"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sign", "[", "h", "]"}]}], "2.", "Pi"}], ",", "0."}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"R1inv", "=", 
       RowBox[{"1.", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Dot", "[", 
          RowBox[{"x1", ",", "x1"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"R2inv", "=", 
       RowBox[{"1.", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Dot", "[", 
          RowBox[{"x2", ",", "x2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"R3inv", "=", 
       RowBox[{"1.", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Dot", "[", 
          RowBox[{"x3", ",", "x3"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"a3OverR1", "=", 
       RowBox[{"a3", " ", "R1inv"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b3OverR2", "=", 
       RowBox[{"b3", " ", "R2inv"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"a1OverR2", "=", 
       RowBox[{"a1", " ", "R2inv"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b1OverR3", "=", 
       RowBox[{"b1", " ", "R3inv"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"a2OverR3", "=", 
       RowBox[{"a2", " ", "R3inv"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b2OverR1", "=", 
       RowBox[{"b2", " ", "R1inv"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cOverh1", "=", 
       RowBox[{"h", " ", "h1inv"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cOverh2", "=", 
       RowBox[{"h", " ", "h2inv"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cOverh3", "=", 
       RowBox[{"h", " ", "h3inv"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"factor2", "=", 
       RowBox[{"0.5", " ", "h", " ", "\[Kappa]", " ", "\[Kappa]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"factor1", "=", 
       RowBox[{
        RowBox[{"h", " ", "factor2"}], "-", "1."}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Plus", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"factor1", " ", 
         RowBox[{"Plus", "[", "\[IndentingNewLine]", 
          RowBox[{"anglesum", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ArcTan", "[", 
             RowBox[{"cOverh3", " ", "b3OverR2"}], "]"}], "-", 
            RowBox[{"ArcTan", "[", 
             RowBox[{"cOverh3", " ", "a3OverR1"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ArcTan", "[", 
             RowBox[{"cOverh1", " ", "b1OverR3"}], "]"}], "-", 
            RowBox[{"ArcTan", "[", 
             RowBox[{"cOverh1", " ", "a1OverR2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ArcTan", "[", 
             RowBox[{"cOverh2", " ", "b2OverR1"}], "]"}], "-", 
            RowBox[{"ArcTan", "[", 
             RowBox[{"cOverh2", " ", "a2OverR3"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"factor2", " ", 
         RowBox[{"Plus", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"h3", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ArcTanh", "[", "b3OverR2", "]"}], "-", 
              RowBox[{"ArcTanh", "[", "a3OverR1", "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"h1", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ArcTanh", "[", "b1OverR3", "]"}], "-", 
              RowBox[{"ArcTanh", "[", "a1OverR2", "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"h2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ArcTanh", "[", "b2OverR1", "]"}], "-", 
              RowBox[{"ArcTanh", "[", "a2OverR3", "]"}]}], ")"}]}]}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.885955481365182*^9, 3.885956008410532*^9}, {
   3.885956079751328*^9, 3.885956088530217*^9}, {3.88595614313274*^9, 
   3.88595614328738*^9}, 3.8859562250125*^9, {3.885956273998617*^9, 
   3.8859564638142014`*^9}, {3.885956513822311*^9, 3.885956522825622*^9}, 
   3.8859565560479193`*^9, {3.885956858781496*^9, 3.885956908212117*^9}, {
   3.885956978889168*^9, 3.885957526826556*^9}, {3.885957561947304*^9, 
   3.8859575834531393`*^9}, {3.885957683870393*^9, 3.8859577676482697`*^9}, {
   3.885957804045156*^9, 3.88595780708665*^9}, {3.885958639197275*^9, 
   3.8859587637372913`*^9}, {3.885958796444151*^9, 3.8859588055673037`*^9}, {
   3.885958901243121*^9, 3.885958912820491*^9}, 3.885958997588912*^9, {
   3.885959077686623*^9, 3.8859590959095182`*^9}, {3.885959190680037*^9, 
   3.8859592377902203`*^9}, {3.8859592831207933`*^9, 3.88595929666763*^9}, {
   3.88595936860266*^9, 3.885959452502472*^9}, {3.88595950947691*^9, 
   3.885959512428406*^9}, {3.885959615072523*^9, 3.88595963191922*^9}, {
   3.8859597032393513`*^9, 3.8859597047706823`*^9}, {3.885959815541868*^9, 
   3.885959856903955*^9}, {3.885959907767263*^9, 3.8859599196501083`*^9}, {
   3.885959968049223*^9, 3.885960031101777*^9}, {3.885960551176098*^9, 
   3.885960578582655*^9}, {3.885960632602436*^9, 3.885960632868149*^9}, {
   3.885960665577083*^9, 3.885960667474853*^9}, {3.8859608296603203`*^9, 
   3.885960849944271*^9}, {3.885960898044639*^9, 3.8859609053806*^9}, {
   3.8859609767191668`*^9, 3.885961005927514*^9}, {3.886239095586844*^9, 
   3.886239242208001*^9}, {3.88623927865522*^9, 3.8862392830116053`*^9}, 
   3.886239340694376*^9, {3.8862395949032393`*^9, 3.886239602675193*^9}, {
   3.886242533129277*^9, 3.8862426899826593`*^9}, {3.8862427394340754`*^9, 
   3.8862427410212317`*^9}, {3.88624293900184*^9, 3.886243035862493*^9}, {
   3.886243070576478*^9, 3.886243125234005*^9}, 3.886243172369646*^9, {
   3.886243204489359*^9, 3.886243207014639*^9}, {3.886243761493741*^9, 
   3.886243768524053*^9}, {3.886243816375742*^9, 3.886243845270857*^9}, {
   3.886243890329372*^9, 3.8862438913790503`*^9}, {3.886244080816086*^9, 
   3.886244185265211*^9}, {3.886244335394088*^9, 3.886244422294201*^9}, {
   3.886244776821048*^9, 3.88624486075955*^9}, {3.886245113236511*^9, 
   3.886245145597938*^9}, {3.886245182645237*^9, 3.886245188975293*^9}, {
   3.886245226528611*^9, 3.8862453692917337`*^9}, {3.886245469045751*^9, 
   3.886245473890733*^9}, {3.886245506643564*^9, 3.886245661178513*^9}, {
   3.886245700060399*^9, 3.8862457485331497`*^9}, {3.886245808436164*^9, 
   3.886245886396484*^9}, {3.886246042768064*^9, 3.886246083489573*^9}, {
   3.886248714713327*^9, 3.886248717820259*^9}, {3.886306183917122*^9, 
   3.886306184269293*^9}, {3.886311082841363*^9, 3.88631110087562*^9}, {
   3.886311293067933*^9, 3.886311296974721*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"7bc68429-920c-47eb-b290-6f79911c4484"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DoubleLayerSingularPartReference", "[", 
     RowBox[{
      RowBox[{"A_", "?", "VectorQ"}], ",", 
      RowBox[{"B_", "?", "VectorQ"}], ",", 
      RowBox[{"y_", "?", "VectorQ"}], ",", 
      RowBox[{"\[Nu]_", "?", "VectorQ"}], ",", "\[Kappa]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "v", ",", "F", ",", "Z", ",", "c", ",", "h", ",", "R\[Alpha]", ",", 
        "R\[Alpha]R\[Alpha]", ",", "R\[Beta]", ",", "R\[Beta]R\[Beta]", ",", 
        "a", ",", "b", ",", "L\[Alpha]", ",", "L\[Beta]", ",", "\[Alpha]", 
        ",", "\[Beta]", ",", "area", ",", "e", ",", "SignedArea", ",", 
        "result"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"B", "-", "A"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"y", "-", "A"}], ",", "\[Nu]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"F", "=", 
        RowBox[{"y", "-", 
         RowBox[{"\[Nu]", " ", "c"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Z", "=", 
        RowBox[{"A", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{
              RowBox[{"A", "-", "F"}], ",", "v"}], "]"}], "/", 
            RowBox[{"Dot", "[", 
             RowBox[{"v", ",", "v"}], "]"}]}], ")"}], " ", "v"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"Norm", "[", 
           RowBox[{"y", "-", "F"}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"Dot", "[", 
           RowBox[{"\[Nu]", ",", 
            RowBox[{"y", "-", "F"}]}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"h", "=", 
        RowBox[{"Norm", "[", 
         RowBox[{"F", "-", "Z"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"R\[Alpha]R\[Alpha]", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"y", "-", "A"}], ",", 
          RowBox[{"y", "-", "A"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"R\[Beta]R\[Beta]", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"y", "-", "B"}], ",", 
          RowBox[{"y", "-", "B"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"R\[Alpha]", "=", 
        RowBox[{"Sqrt", "[", "R\[Alpha]R\[Alpha]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R\[Beta]", "=", 
        RowBox[{"Sqrt", "[", "R\[Beta]R\[Beta]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"Cross", "[", 
              RowBox[{"\[Nu]", ",", 
               RowBox[{"A", "-", "Z"}]}], "]"}], ",", 
             RowBox[{"F", "-", "Z"}]}], "]"}], "/", "h"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"b", "=", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"Cross", "[", 
              RowBox[{"\[Nu]", ",", 
               RowBox[{"B", "-", "Z"}]}], "]"}], ",", 
             RowBox[{"F", "-", "Z"}]}], "]"}], "/", "h"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"F", "-", "Z"}], ",", "\[Nu]"}], "]"}], ",", 
           RowBox[{"A", "-", "Z"}]}], "]"}], "/", "h"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"F", "-", "Z"}], ",", "\[Nu]"}], "]"}], ",", 
           RowBox[{"B", "-", "Z"}]}], "]"}], "/", "h"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"L\[Alpha]", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"R\[Alpha]R\[Alpha]", "-", 
          RowBox[{"c", " ", "c"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"L\[Beta]", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"R\[Beta]R\[Beta]", "-", 
          RowBox[{"c", " ", "c"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"ArcSin", "[", 
         RowBox[{"a", "/", "L\[Alpha]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Beta]", "=", 
        RowBox[{"ArcSin", "[", 
         RowBox[{"b", "/", "L\[Beta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"TODO", ":", " ", 
         RowBox[{
          RowBox[{
          "Sum", " ", "of", " ", "the", " ", "terms", " ", "\[Alpha]"}], "-", 
          
          RowBox[{
          "\[Beta]", " ", "is", " ", "either", " ", "0", " ", "or", " ", "2", 
           " ", 
           RowBox[{"Pi", ".", " ", "Use"}], " ", "this", " ", "to", " ", 
           "avoid", " ", 
           RowBox[{"ArcSin", "!"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], " ", 
               SuperscriptBox["\[Kappa]", "2"]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"\[Alpha]", "-", "\[Beta]", "-", 
              RowBox[{"ArcTan", "[", 
               FractionBox[
                RowBox[{"a", " ", "c"}], 
                RowBox[{"h", " ", "R\[Alpha]"}]], "]"}], "+", 
              RowBox[{"ArcTan", "[", 
               FractionBox[
                RowBox[{"b", " ", "c"}], 
                RowBox[{"h", " ", "R\[Beta]"}]], "]"}]}], ")"}]}], "+", 
           RowBox[{"c", " ", "h", " ", 
            SuperscriptBox["\[Kappa]", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ArcTanh", "[", 
               FractionBox["b", "R\[Beta]"], "]"}], "-", 
              RowBox[{"ArcTanh", "[", 
               FractionBox["a", "R\[Alpha]"], "]"}]}], ")"}]}]}], ")"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Sign", "[", "c", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", "\[Alpha]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            SuperscriptBox["c", "2"], " ", 
            RowBox[{
             SuperscriptBox["\[Kappa]", "2"], "/", "2"}]}]}], ")"}]}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              SuperscriptBox["c", "2"], " ", 
              RowBox[{
               SuperscriptBox["\[Kappa]", "2"], "/", "2"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              FractionBox[
               RowBox[{"a", " ", "c"}], 
               RowBox[{"h", " ", "R\[Alpha]"}]], "]"}], "-", 
             RowBox[{"ArcTan", "[", 
              FractionBox[
               RowBox[{"b", " ", "c"}], 
               RowBox[{"h", " ", "R\[Beta]"}]], "]"}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"c", " ", "h", " ", 
             RowBox[{
              SuperscriptBox["\[Kappa]", "2"], "/", "2"}]}], ")"}], " ", 
           RowBox[{"ArcTanh", "[", 
            FractionBox["a", "R\[Alpha]"], "]"}]}], "+", 
          RowBox[{"c", " ", "h", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", 
           RowBox[{"ArcTanh", "[", 
            FractionBox["b", "R\[Beta]"], "]"}]}]}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DoubleLayerSingularPartReference", "[", 
     RowBox[{
      RowBox[{"y_", "?", "VectorQ"}], ",", 
      RowBox[{"T_", "?", "MatrixQ"}], ",", "\[Kappa]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[Nu]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Nu]", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"T", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "-", 
            RowBox[{"T", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Plus", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DoubleLayerSingularPartReference", "[", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"T", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "y", ",", "\[Nu]", ",", 
           "\[Kappa]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"DoubleLayerSingularPartReference", "[", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"T", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "y", ",", "\[Nu]", ",", 
           "\[Kappa]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"DoubleLayerSingularPartReference", "[", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"T", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "y", ",", "\[Nu]", ",", 
           "\[Kappa]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DoubleLayerSingularPart", "[", 
     RowBox[{
      RowBox[{"S_", "?", "MatrixQ"}], ",", 
      RowBox[{"T_", "?", "MatrixQ"}], ",", "\[Kappa]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Area", "[", 
      RowBox[{"Triangle", "[", "S", "]"}], "]"}], 
     RowBox[{"DoubleLayerSingularPart", "[", 
      RowBox[{
       RowBox[{"Mean", "[", "S", "]"}], ",", "T", ",", "\[Kappa]"}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DoubleLayerRegularPart", "[", 
     RowBox[{
      RowBox[{"y_", "?", "VectorQ"}], ",", 
      RowBox[{"T_", "?", "MatrixQ"}], ",", "\[Kappa]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "\[Nu]", ",", "R", ",", "c"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "=", 
        RowBox[{"Mean", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Nu]", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"T", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "-", 
            RowBox[{"T", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R", "=", 
        RowBox[{"Norm", "[", 
         RowBox[{"y", "-", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"y", "-", "x"}], ",", "\[Nu]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"c", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{
               SuperscriptBox["R", "2"], " ", 
               SuperscriptBox["\[Kappa]", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", "R", " ", "\[Kappa]"}]], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 RowBox[{
                 "2", " ", "\[ImaginaryI]", " ", "R", " ", "\[Kappa]"}]}], 
                ")"}]}]}], ")"}]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["R", "3"]}]]}], ")"}], 
        RowBox[{"Area", "[", 
         RowBox[{"Triangle", "[", "T", "]"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DoubleLayerRegularPart", "[", 
     RowBox[{
      RowBox[{"S_", "?", "MatrixQ"}], ",", 
      RowBox[{"T_", "?", "MatrixQ"}], ",", "\[Kappa]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Area", "[", 
      RowBox[{"Triangle", "[", "S", "]"}], "]"}], " ", 
     RowBox[{"DoubleLayerRegularPart", "[", 
      RowBox[{
       RowBox[{"Mean", "[", "S", "]"}], ",", "T", ",", "\[Kappa]"}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DoubleLayerNaive", "[", 
     RowBox[{
      RowBox[{"y_", "?", "VectorQ"}], ",", 
      RowBox[{"T_", "?", "MatrixQ"}], ",", "\[Kappa]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "\[Nu]", ",", "R", ",", "c"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "=", 
        RowBox[{"Mean", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Nu]", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"T", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "-", 
            RowBox[{"T", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R", "=", 
        RowBox[{"Norm", "[", 
         RowBox[{"y", "-", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"y", "-", "x"}], ",", "\[Nu]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "R", " ", "\[Kappa]"}]], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[ImaginaryI]", " ", "R", " ", "\[Kappa]"}]}], ")"}]}], 
          
          SuperscriptBox["R", "3"]], ")"}], 
        RowBox[{"Area", "[", 
         RowBox[{"Triangle", "[", "T", "]"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DoubleLayerNaive", "[", 
    RowBox[{
     RowBox[{"S_", "?", "MatrixQ"}], ",", 
     RowBox[{"T_", "?", "MatrixQ"}], ",", "\[Kappa]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Area", "[", 
     RowBox[{"Triangle", "[", "S", "]"}], "]"}], 
    RowBox[{"DoubleLayerNaive", "[", 
     RowBox[{
      RowBox[{"Mean", "[", "S", "]"}], ",", "T", ",", "\[Kappa]"}], "]"}]}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.885786978853606*^9, 3.8857869800682573`*^9}, {
   3.885787033242117*^9, 3.885787040225931*^9}, {3.8857871287923107`*^9, 
   3.885787132740881*^9}, {3.8857871678580914`*^9, 3.885787189588276*^9}, {
   3.885787352477109*^9, 3.88578738730577*^9}, {3.885787727450955*^9, 
   3.885787733559371*^9}, {3.885788072133892*^9, 3.885788085253883*^9}, {
   3.885788175847041*^9, 3.885788246742392*^9}, {3.885788737983515*^9, 
   3.88578876491724*^9}, 3.885788938297596*^9, 3.8857891149054813`*^9, {
   3.885789230464253*^9, 3.885789251742221*^9}, {3.885789544900631*^9, 
   3.885789562684142*^9}, {3.88579153760457*^9, 3.885791583010016*^9}, {
   3.885791622550392*^9, 3.885791624691642*^9}, {3.885791678093288*^9, 
   3.8857917123155193`*^9}, {3.8857917829873343`*^9, 
   3.8857918009286747`*^9}, {3.885791853235064*^9, 3.885791874542161*^9}, {
   3.885791921783019*^9, 3.885791922493869*^9}, {3.88579195764233*^9, 
   3.885792067776115*^9}, {3.8857920996877127`*^9, 3.8857921346291523`*^9}, {
   3.885792262876348*^9, 3.885792334123582*^9}, {3.885792403860095*^9, 
   3.885792405881948*^9}, {3.885792568823226*^9, 3.885792598636524*^9}, {
   3.8857927201050863`*^9, 3.885792767866177*^9}, {3.885792824094885*^9, 
   3.885792851962322*^9}, {3.8857929771730223`*^9, 3.88579298645343*^9}, {
   3.885793186739579*^9, 3.885793256011341*^9}, {3.885793439578143*^9, 
   3.885793488148871*^9}, {3.885793634747076*^9, 3.885793643792964*^9}, {
   3.885793684244481*^9, 3.88579368651975*^9}, 3.885793801827795*^9, {
   3.88579388221168*^9, 3.8857939270129757`*^9}, 3.885794118568116*^9, 
   3.8857942324009237`*^9, 3.885794266431086*^9, {3.885794444835651*^9, 
   3.8857944797207117`*^9}, {3.88579487205975*^9, 3.885794877266317*^9}, 
   3.8857949317660513`*^9, 3.885795100828087*^9, {3.8857952019986553`*^9, 
   3.8857952028545027`*^9}, {3.885795709356799*^9, 3.885795713121269*^9}, {
   3.885795839987986*^9, 3.885795845281023*^9}, {3.885795998983967*^9, 
   3.885796001091814*^9}, {3.885796046293013*^9, 3.8857961910095797`*^9}, {
   3.885796395648202*^9, 3.885796397525557*^9}, {3.88579656457759*^9, 
   3.885796565897135*^9}, {3.885798748020442*^9, 3.885798749507489*^9}, 
   3.88579879556676*^9, {3.8857999583690157`*^9, 3.885799961875836*^9}, {
   3.8858002320948973`*^9, 3.885800276985198*^9}, {3.885819380717538*^9, 
   3.885819417176846*^9}, 3.885819451529304*^9, {3.885819508169524*^9, 
   3.8858195256262693`*^9}, {3.885819559668376*^9, 3.885819740640119*^9}, {
   3.885820006697465*^9, 3.885820050238228*^9}, 3.8858201843331757`*^9, 
   3.885820227597698*^9, {3.885820340007221*^9, 3.8858203679260607`*^9}, {
   3.8858204500984497`*^9, 3.885820498479885*^9}, {3.8858205857409554`*^9, 
   3.8858206586908627`*^9}, {3.885820852875312*^9, 3.885820867784834*^9}, {
   3.8858211407005043`*^9, 3.885821220795919*^9}, {3.8858212519477158`*^9, 
   3.885821410772627*^9}, {3.885821544441324*^9, 3.885821556358549*^9}, {
   3.88582164351414*^9, 3.8858217327721357`*^9}, {3.885956106628169*^9, 
   3.885956108763081*^9}, {3.88595618849128*^9, 3.885956220867757*^9}, {
   3.885956484310359*^9, 3.885956491511257*^9}, {3.885960333083734*^9, 
   3.8859603615850773`*^9}, {3.8859604442912292`*^9, 
   3.8859605041306887`*^9}, {3.886306585838485*^9, 3.886306599069531*^9}, {
   3.8863111011326838`*^9, 3.886311106670507*^9}, {3.886311201849674*^9, 
   3.8863112341111526`*^9}, {3.886311327611105*^9, 3.8863113378719273`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"86de4047-5d0a-43fc-aff0-0a0d4aef7b16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Bad", " ", "example"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.03149622317141976`", ",", 
         RowBox[{"-", "0.6925238752727543`"}], ",", "0.2079188097608915`"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.8052934217098078`", ",", 
         RowBox[{"-", "0.23023778925676108`"}], ",", "0.7597499307422622`"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.9936635971236556`"}], ",", 
         RowBox[{"-", "0.7276529404444747`"}], ",", "0.4946842201962687`"}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"y", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.11234985735061365`"}], ",", "0.7737492570419247`", ",", 
       RowBox[{"-", "0.355765672248201`"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8859595542716217`*^9, 3.885959574592266*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"2af51725-0dc7-4e75-bf9c-c6f6d54a11ce"],

Cell[BoxData["T"], "Input",
 CellChangeTimes->{3.885959561011455*^9},
 CellLabel->
  "In[2524]:=",ExpressionUUID->"7330966c-6f68-4665-b3e0-b0691d38b3d1"],

Cell[CellGroupData[{

Cell[BoxData["y"], "Input",
 CellChangeTimes->{{3.885959566586278*^9, 3.885959570230382*^9}},
 CellLabel->
  "In[2525]:=",ExpressionUUID->"cd953ece-2056-4812-8f32-9e2344310db3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.11234985735061365`"}], ",", "0.7737492570419247`", ",", 
   RowBox[{"-", "0.355765672248201`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.885959570497184*^9},
 CellLabel->
  "Out[2525]=",ExpressionUUID->"316817b6-d14e-4f19-a4e7-a48a7442fb6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Kappa]", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"Mean", "[", "T", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Nu]", "=", 
   RowBox[{"Normalize", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M", "=", 
    RowBox[{"Subdivide", "[", 
     RowBox[{
      RowBox[{"Init", "[", 
       RowBox[{"mesh", ",", "T", ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"\"\<Subdivisions\>\"", "->", "6"}], ",", 
      RowBox[{"Method", "->", "\"\<Planar\>\""}], ",", 
      RowBox[{"\"\<AverageBoundaryPoints\>\"", "->", "False"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"s", ",", "t", ",", "u", ",", "v"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "+", 
    RowBox[{"s", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"t", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"y", "-", "X"}], ",", 
      RowBox[{"y", "-", "X"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"integrand", "=", 
    RowBox[{"fR", "/.", 
     RowBox[{"c", "->", 
      RowBox[{"-", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"x", "-", "y"}], ",", "\[Nu]"}], "]"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J", "=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Det", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Transpose]"}], ".", "#"}], "&"}], "[", 
       RowBox[{"D", "[", 
        RowBox[{"X", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s", ",", "t"}], "}"}], ",", "1"}], "}"}]}], "]"}], "]"}],
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"\"\<intOneMidpoint\>\"", "->", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"intOneMidpoint", "=", 
     RowBox[{"DoubleLayerNaive", "[", 
      RowBox[{"y", ",", "T", ",", "\[Kappa]"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\"\<intQuasiMonteCarlo\>\"", "->", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"intQuasiMonteCarlo", "=", 
     RowBox[{"J", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{"integrand", ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"1", "-", "s"}]}], "}"}], ",", 
        RowBox[{"Method", "->", "\"\<QuasiMonteCarlo\>\""}]}], "]"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\"\<intLocalAdaptive\>\"", "->", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"intLocalAdaptive", "=", 
     RowBox[{"J", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{"integrand", ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"1", "-", "s"}]}], "}"}], ",", 
        RowBox[{"Method", "->", "\"\<LocalAdaptive\>\""}], ",", 
        RowBox[{"PrecisionGoal", "->", "14"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\"\<intAnalytical\>\"", "->", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"intAnalytical", "=", 
     RowBox[{
      RowBox[{"DoubleLayerSingularPart", "[", 
       RowBox[{"y", ",", "T", ",", "\[Kappa]"}], "]"}], "+", 
      RowBox[{"DoubleLayerRegularPart", "[", 
       RowBox[{"y", ",", "T", ",", "\[Kappa]"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Abs", "[", 
   RowBox[{"intLocalAdaptive", "-", "intOneMidpoint"}], "]"}], "/", 
  RowBox[{"Abs", "[", "intLocalAdaptive", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"\"\<Error Adaptive\>\"", "->", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{"intLocalAdaptive", "-", "intAnalytical"}], "]"}], "/", 
   RowBox[{"Abs", "[", "intLocalAdaptive", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\"\<Error MonteCarlo\>\"", "->", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{"intQuasiMonteCarlo", "-", "intAnalytical"}], "]"}], "/", 
   RowBox[{"Abs", "[", "intLocalAdaptive", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\"\<Error Adaptive\>\"", "->", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"intLocalAdaptive", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DoubleLayerSingularPartReference", "[", 
         RowBox[{"y", ",", "T", ",", "\[Kappa]"}], "]"}], "+", 
        RowBox[{"DoubleLayerRegularPart", "[", 
         RowBox[{"y", ",", "T", ",", "\[Kappa]"}], "]"}]}], ")"}]}], "]"}], 
    "/", 
    RowBox[{"Abs", "[", "intLocalAdaptive", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.885819888903873*^9, 3.885819893608581*^9}, {
   3.885820079717478*^9, 3.8858200956759167`*^9}, {3.8858202513003073`*^9, 
   3.885820251521373*^9}, {3.885820691240184*^9, 3.885820701222534*^9}, 
   3.8858207623187733`*^9, {3.885820915463077*^9, 3.885820915830996*^9}, 
   3.885820970110654*^9, {3.885821012924728*^9, 3.885821092068171*^9}, {
   3.8858215843515043`*^9, 3.8858215922579317`*^9}, 3.8859575461568203`*^9, {
   3.885957858132985*^9, 3.885957872833816*^9}, {3.885959578439406*^9, 
   3.8859595810298033`*^9}, {3.8859597921228952`*^9, 3.885959798620953*^9}, {
   3.885960715656308*^9, 3.885960777882442*^9}, 3.8859609281180468`*^9, 
   3.886311107439629*^9},
 CellLabel->"In[81]:=",ExpressionUUID->"ef9c2e6d-bce6-45c4-992f-38264ebd4c69"],

Cell[BoxData[
 RowBox[{"\<\"intOneMidpoint\"\>", "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"0.00025`", ",", 
    RowBox[{"0.801253953790286`", "\[VeryThinSpace]", "+", 
     RowBox[{"4.35140240281557`*^-8", " ", "\[ImaginaryI]"}]}]}], 
   "}"}]}]], "Output",
 CellChangeTimes->{{3.88582106892*^9, 3.885821092959783*^9}, 
   3.885821180511609*^9, {3.885821269851337*^9, 3.885821292598508*^9}, {
   3.8858213436319103`*^9, 3.8858213455982857`*^9}, {3.885821393796534*^9, 
   3.885821418742097*^9}, {3.8858215661142893`*^9, 3.885821592746462*^9}, 
   3.8858217370377693`*^9, 3.885956017813037*^9, {3.88595727874271*^9, 
   3.885957314730135*^9}, {3.885957533433296*^9, 3.885957558767139*^9}, {
   3.885957814809636*^9, 3.885957824350588*^9}, {3.885957873393243*^9, 
   3.885957883157692*^9}, {3.885958767797996*^9, 3.88595877756479*^9}, {
   3.885958958646565*^9, 3.885958967416065*^9}, {3.885959099569586*^9, 
   3.885959184464501*^9}, {3.8859592422193727`*^9, 3.885959361018589*^9}, {
   3.8859594571504183`*^9, 3.885959521524*^9}, {3.885959581355072*^9, 
   3.885959642628861*^9}, {3.885959712081353*^9, 3.885959713554895*^9}, {
   3.885959801284485*^9, 3.885959827272449*^9}, {3.8859598597717133`*^9, 
   3.885959864564445*^9}, {3.88595992297654*^9, 3.8859599270881166`*^9}, {
   3.885960064216976*^9, 3.8859601522818117`*^9}, {3.885960262421507*^9, 
   3.885960282290105*^9}, {3.885960372248829*^9, 3.885960420368408*^9}, {
   3.8859605089406357`*^9, 3.885960524073968*^9}, {3.88596064263603*^9, 
   3.885960785432184*^9}, {3.8859609098043222`*^9, 3.88596095246841*^9}, 
   3.886242849366062*^9, 3.886242927446569*^9, {3.886243045606678*^9, 
   3.886243050912917*^9}, {3.886243184297594*^9, 3.8862431916260366`*^9}, {
   3.8862438489596663`*^9, 3.886243854184699*^9}, {3.886244161761443*^9, 
   3.886244202051*^9}, {3.8862442328527527`*^9, 3.886244239230404*^9}, {
   3.886244487638544*^9, 3.886244506904839*^9}, {3.886244848722135*^9, 
   3.886244852122937*^9}, 3.886245149978559*^9, 3.886245199455751*^9, {
   3.886245243818048*^9, 3.88624524938937*^9}, {3.886245295892758*^9, 
   3.886245302949815*^9}, {3.886245478329138*^9, 3.8862454838921413`*^9}, {
   3.886245576801202*^9, 3.886245579858535*^9}, {3.886245824757681*^9, 
   3.8862458272535467`*^9}, {3.886246090111725*^9, 3.886246091711247*^9}, {
   3.8862487208170567`*^9, 3.8862487232744923`*^9}, {3.886311269972189*^9, 
   3.886311272544612*^9}, {3.886311354834639*^9, 3.8863113580546217`*^9}},
 CellLabel->"Out[92]=",ExpressionUUID->"a22280cb-976e-4b33-a15b-950c2195b6ff"],

Cell[BoxData[
 RowBox[{"\<\"intQuasiMonteCarlo\"\>", "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"0.030403`", ",", "0.8438241927465608`"}], "}"}]}]], "Output",
 CellChangeTimes->{{3.88582106892*^9, 3.885821092959783*^9}, 
   3.885821180511609*^9, {3.885821269851337*^9, 3.885821292598508*^9}, {
   3.8858213436319103`*^9, 3.8858213455982857`*^9}, {3.885821393796534*^9, 
   3.885821418742097*^9}, {3.8858215661142893`*^9, 3.885821592746462*^9}, 
   3.8858217370377693`*^9, 3.885956017813037*^9, {3.88595727874271*^9, 
   3.885957314730135*^9}, {3.885957533433296*^9, 3.885957558767139*^9}, {
   3.885957814809636*^9, 3.885957824350588*^9}, {3.885957873393243*^9, 
   3.885957883157692*^9}, {3.885958767797996*^9, 3.88595877756479*^9}, {
   3.885958958646565*^9, 3.885958967416065*^9}, {3.885959099569586*^9, 
   3.885959184464501*^9}, {3.8859592422193727`*^9, 3.885959361018589*^9}, {
   3.8859594571504183`*^9, 3.885959521524*^9}, {3.885959581355072*^9, 
   3.885959642628861*^9}, {3.885959712081353*^9, 3.885959713554895*^9}, {
   3.885959801284485*^9, 3.885959827272449*^9}, {3.8859598597717133`*^9, 
   3.885959864564445*^9}, {3.88595992297654*^9, 3.8859599270881166`*^9}, {
   3.885960064216976*^9, 3.8859601522818117`*^9}, {3.885960262421507*^9, 
   3.885960282290105*^9}, {3.885960372248829*^9, 3.885960420368408*^9}, {
   3.8859605089406357`*^9, 3.885960524073968*^9}, {3.88596064263603*^9, 
   3.885960785432184*^9}, {3.8859609098043222`*^9, 3.88596095246841*^9}, 
   3.886242849366062*^9, 3.886242927446569*^9, {3.886243045606678*^9, 
   3.886243050912917*^9}, {3.886243184297594*^9, 3.8862431916260366`*^9}, {
   3.8862438489596663`*^9, 3.886243854184699*^9}, {3.886244161761443*^9, 
   3.886244202051*^9}, {3.8862442328527527`*^9, 3.886244239230404*^9}, {
   3.886244487638544*^9, 3.886244506904839*^9}, {3.886244848722135*^9, 
   3.886244852122937*^9}, 3.886245149978559*^9, 3.886245199455751*^9, {
   3.886245243818048*^9, 3.88624524938937*^9}, {3.886245295892758*^9, 
   3.886245302949815*^9}, {3.886245478329138*^9, 3.8862454838921413`*^9}, {
   3.886245576801202*^9, 3.886245579858535*^9}, {3.886245824757681*^9, 
   3.8862458272535467`*^9}, {3.886246090111725*^9, 3.886246091711247*^9}, {
   3.8862487208170567`*^9, 3.8862487232744923`*^9}, {3.886311269972189*^9, 
   3.886311272544612*^9}, {3.886311354834639*^9, 3.8863113580822144`*^9}},
 CellLabel->"Out[93]=",ExpressionUUID->"7a7017c1-d3c8-455f-b8c0-5edc19110ffc"],

Cell[BoxData[
 RowBox[{"\<\"intLocalAdaptive\"\>", "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"0.172538`", ",", 
    RowBox[{"0.8437270800214799`", "\[VeryThinSpace]", "+", 
     RowBox[{"4.351398524274475`*^-8", " ", "\[ImaginaryI]"}]}]}], 
   "}"}]}]], "Output",
 CellChangeTimes->{{3.88582106892*^9, 3.885821092959783*^9}, 
   3.885821180511609*^9, {3.885821269851337*^9, 3.885821292598508*^9}, {
   3.8858213436319103`*^9, 3.8858213455982857`*^9}, {3.885821393796534*^9, 
   3.885821418742097*^9}, {3.8858215661142893`*^9, 3.885821592746462*^9}, 
   3.8858217370377693`*^9, 3.885956017813037*^9, {3.88595727874271*^9, 
   3.885957314730135*^9}, {3.885957533433296*^9, 3.885957558767139*^9}, {
   3.885957814809636*^9, 3.885957824350588*^9}, {3.885957873393243*^9, 
   3.885957883157692*^9}, {3.885958767797996*^9, 3.88595877756479*^9}, {
   3.885958958646565*^9, 3.885958967416065*^9}, {3.885959099569586*^9, 
   3.885959184464501*^9}, {3.8859592422193727`*^9, 3.885959361018589*^9}, {
   3.8859594571504183`*^9, 3.885959521524*^9}, {3.885959581355072*^9, 
   3.885959642628861*^9}, {3.885959712081353*^9, 3.885959713554895*^9}, {
   3.885959801284485*^9, 3.885959827272449*^9}, {3.8859598597717133`*^9, 
   3.885959864564445*^9}, {3.88595992297654*^9, 3.8859599270881166`*^9}, {
   3.885960064216976*^9, 3.8859601522818117`*^9}, {3.885960262421507*^9, 
   3.885960282290105*^9}, {3.885960372248829*^9, 3.885960420368408*^9}, {
   3.8859605089406357`*^9, 3.885960524073968*^9}, {3.88596064263603*^9, 
   3.885960785432184*^9}, {3.8859609098043222`*^9, 3.88596095246841*^9}, 
   3.886242849366062*^9, 3.886242927446569*^9, {3.886243045606678*^9, 
   3.886243050912917*^9}, {3.886243184297594*^9, 3.8862431916260366`*^9}, {
   3.8862438489596663`*^9, 3.886243854184699*^9}, {3.886244161761443*^9, 
   3.886244202051*^9}, {3.8862442328527527`*^9, 3.886244239230404*^9}, {
   3.886244487638544*^9, 3.886244506904839*^9}, {3.886244848722135*^9, 
   3.886244852122937*^9}, 3.886245149978559*^9, 3.886245199455751*^9, {
   3.886245243818048*^9, 3.88624524938937*^9}, {3.886245295892758*^9, 
   3.886245302949815*^9}, {3.886245478329138*^9, 3.8862454838921413`*^9}, {
   3.886245576801202*^9, 3.886245579858535*^9}, {3.886245824757681*^9, 
   3.8862458272535467`*^9}, {3.886246090111725*^9, 3.886246091711247*^9}, {
   3.8862487208170567`*^9, 3.8862487232744923`*^9}, {3.886311269972189*^9, 
   3.886311272544612*^9}, {3.886311354834639*^9, 3.886311358255484*^9}},
 CellLabel->"Out[94]=",ExpressionUUID->"0e9c1a49-d861-4602-be41-5bd9d6bb9412"],

Cell[BoxData[
 RowBox[{"\<\"intAnalytical\"\>", "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"0.000525`", ",", 
    RowBox[{"0.8437270800310432`", "\[VeryThinSpace]", "+", 
     RowBox[{"4.351402402831918`*^-8", " ", "\[ImaginaryI]"}]}]}], 
   "}"}]}]], "Output",
 CellChangeTimes->{{3.88582106892*^9, 3.885821092959783*^9}, 
   3.885821180511609*^9, {3.885821269851337*^9, 3.885821292598508*^9}, {
   3.8858213436319103`*^9, 3.8858213455982857`*^9}, {3.885821393796534*^9, 
   3.885821418742097*^9}, {3.8858215661142893`*^9, 3.885821592746462*^9}, 
   3.8858217370377693`*^9, 3.885956017813037*^9, {3.88595727874271*^9, 
   3.885957314730135*^9}, {3.885957533433296*^9, 3.885957558767139*^9}, {
   3.885957814809636*^9, 3.885957824350588*^9}, {3.885957873393243*^9, 
   3.885957883157692*^9}, {3.885958767797996*^9, 3.88595877756479*^9}, {
   3.885958958646565*^9, 3.885958967416065*^9}, {3.885959099569586*^9, 
   3.885959184464501*^9}, {3.8859592422193727`*^9, 3.885959361018589*^9}, {
   3.8859594571504183`*^9, 3.885959521524*^9}, {3.885959581355072*^9, 
   3.885959642628861*^9}, {3.885959712081353*^9, 3.885959713554895*^9}, {
   3.885959801284485*^9, 3.885959827272449*^9}, {3.8859598597717133`*^9, 
   3.885959864564445*^9}, {3.88595992297654*^9, 3.8859599270881166`*^9}, {
   3.885960064216976*^9, 3.8859601522818117`*^9}, {3.885960262421507*^9, 
   3.885960282290105*^9}, {3.885960372248829*^9, 3.885960420368408*^9}, {
   3.8859605089406357`*^9, 3.885960524073968*^9}, {3.88596064263603*^9, 
   3.885960785432184*^9}, {3.8859609098043222`*^9, 3.88596095246841*^9}, 
   3.886242849366062*^9, 3.886242927446569*^9, {3.886243045606678*^9, 
   3.886243050912917*^9}, {3.886243184297594*^9, 3.8862431916260366`*^9}, {
   3.8862438489596663`*^9, 3.886243854184699*^9}, {3.886244161761443*^9, 
   3.886244202051*^9}, {3.8862442328527527`*^9, 3.886244239230404*^9}, {
   3.886244487638544*^9, 3.886244506904839*^9}, {3.886244848722135*^9, 
   3.886244852122937*^9}, 3.886245149978559*^9, 3.886245199455751*^9, {
   3.886245243818048*^9, 3.88624524938937*^9}, {3.886245295892758*^9, 
   3.886245302949815*^9}, {3.886245478329138*^9, 3.8862454838921413`*^9}, {
   3.886245576801202*^9, 3.886245579858535*^9}, {3.886245824757681*^9, 
   3.8862458272535467`*^9}, {3.886246090111725*^9, 3.886246091711247*^9}, {
   3.8862487208170567`*^9, 3.8862487232744923`*^9}, {3.886311269972189*^9, 
   3.886311272544612*^9}, {3.886311354834639*^9, 3.886311358256833*^9}},
 CellLabel->"Out[95]=",ExpressionUUID->"f29c81e2-44f8-446a-a521-87cc4b8a3ade"],

Cell[BoxData["0.050339887431505186`"], "Output",
 CellChangeTimes->{{3.88582106892*^9, 3.885821092959783*^9}, 
   3.885821180511609*^9, {3.885821269851337*^9, 3.885821292598508*^9}, {
   3.8858213436319103`*^9, 3.8858213455982857`*^9}, {3.885821393796534*^9, 
   3.885821418742097*^9}, {3.8858215661142893`*^9, 3.885821592746462*^9}, 
   3.8858217370377693`*^9, 3.885956017813037*^9, {3.88595727874271*^9, 
   3.885957314730135*^9}, {3.885957533433296*^9, 3.885957558767139*^9}, {
   3.885957814809636*^9, 3.885957824350588*^9}, {3.885957873393243*^9, 
   3.885957883157692*^9}, {3.885958767797996*^9, 3.88595877756479*^9}, {
   3.885958958646565*^9, 3.885958967416065*^9}, {3.885959099569586*^9, 
   3.885959184464501*^9}, {3.8859592422193727`*^9, 3.885959361018589*^9}, {
   3.8859594571504183`*^9, 3.885959521524*^9}, {3.885959581355072*^9, 
   3.885959642628861*^9}, {3.885959712081353*^9, 3.885959713554895*^9}, {
   3.885959801284485*^9, 3.885959827272449*^9}, {3.8859598597717133`*^9, 
   3.885959864564445*^9}, {3.88595992297654*^9, 3.8859599270881166`*^9}, {
   3.885960064216976*^9, 3.8859601522818117`*^9}, {3.885960262421507*^9, 
   3.885960282290105*^9}, {3.885960372248829*^9, 3.885960420368408*^9}, {
   3.8859605089406357`*^9, 3.885960524073968*^9}, {3.88596064263603*^9, 
   3.885960785432184*^9}, {3.8859609098043222`*^9, 3.88596095246841*^9}, 
   3.886242849366062*^9, 3.886242927446569*^9, {3.886243045606678*^9, 
   3.886243050912917*^9}, {3.886243184297594*^9, 3.8862431916260366`*^9}, {
   3.8862438489596663`*^9, 3.886243854184699*^9}, {3.886244161761443*^9, 
   3.886244202051*^9}, {3.8862442328527527`*^9, 3.886244239230404*^9}, {
   3.886244487638544*^9, 3.886244506904839*^9}, {3.886244848722135*^9, 
   3.886244852122937*^9}, 3.886245149978559*^9, 3.886245199455751*^9, {
   3.886245243818048*^9, 3.88624524938937*^9}, {3.886245295892758*^9, 
   3.886245302949815*^9}, {3.886245478329138*^9, 3.8862454838921413`*^9}, {
   3.886245576801202*^9, 3.886245579858535*^9}, {3.886245824757681*^9, 
   3.8862458272535467`*^9}, {3.886246090111725*^9, 3.886246091711247*^9}, {
   3.8862487208170567`*^9, 3.8862487232744923`*^9}, {3.886311269972189*^9, 
   3.886311272544612*^9}, {3.886311354834639*^9, 3.886311358257909*^9}},
 CellLabel->"Out[96]=",ExpressionUUID->"e0d2111b-9fda-4021-a338-634c82a9756a"],

Cell[BoxData[
 RowBox[{"\<\"Error Adaptive\"\>", "\[Rule]", 
  "1.133474198973865`*^-11"}]], "Output",
 CellChangeTimes->{{3.88582106892*^9, 3.885821092959783*^9}, 
   3.885821180511609*^9, {3.885821269851337*^9, 3.885821292598508*^9}, {
   3.8858213436319103`*^9, 3.8858213455982857`*^9}, {3.885821393796534*^9, 
   3.885821418742097*^9}, {3.8858215661142893`*^9, 3.885821592746462*^9}, 
   3.8858217370377693`*^9, 3.885956017813037*^9, {3.88595727874271*^9, 
   3.885957314730135*^9}, {3.885957533433296*^9, 3.885957558767139*^9}, {
   3.885957814809636*^9, 3.885957824350588*^9}, {3.885957873393243*^9, 
   3.885957883157692*^9}, {3.885958767797996*^9, 3.88595877756479*^9}, {
   3.885958958646565*^9, 3.885958967416065*^9}, {3.885959099569586*^9, 
   3.885959184464501*^9}, {3.8859592422193727`*^9, 3.885959361018589*^9}, {
   3.8859594571504183`*^9, 3.885959521524*^9}, {3.885959581355072*^9, 
   3.885959642628861*^9}, {3.885959712081353*^9, 3.885959713554895*^9}, {
   3.885959801284485*^9, 3.885959827272449*^9}, {3.8859598597717133`*^9, 
   3.885959864564445*^9}, {3.88595992297654*^9, 3.8859599270881166`*^9}, {
   3.885960064216976*^9, 3.8859601522818117`*^9}, {3.885960262421507*^9, 
   3.885960282290105*^9}, {3.885960372248829*^9, 3.885960420368408*^9}, {
   3.8859605089406357`*^9, 3.885960524073968*^9}, {3.88596064263603*^9, 
   3.885960785432184*^9}, {3.8859609098043222`*^9, 3.88596095246841*^9}, 
   3.886242849366062*^9, 3.886242927446569*^9, {3.886243045606678*^9, 
   3.886243050912917*^9}, {3.886243184297594*^9, 3.8862431916260366`*^9}, {
   3.8862438489596663`*^9, 3.886243854184699*^9}, {3.886244161761443*^9, 
   3.886244202051*^9}, {3.8862442328527527`*^9, 3.886244239230404*^9}, {
   3.886244487638544*^9, 3.886244506904839*^9}, {3.886244848722135*^9, 
   3.886244852122937*^9}, 3.886245149978559*^9, 3.886245199455751*^9, {
   3.886245243818048*^9, 3.88624524938937*^9}, {3.886245295892758*^9, 
   3.886245302949815*^9}, {3.886245478329138*^9, 3.8862454838921413`*^9}, {
   3.886245576801202*^9, 3.886245579858535*^9}, {3.886245824757681*^9, 
   3.8862458272535467`*^9}, {3.886246090111725*^9, 3.886246091711247*^9}, {
   3.8862487208170567`*^9, 3.8862487232744923`*^9}, {3.886311269972189*^9, 
   3.886311272544612*^9}, {3.886311354834639*^9, 3.886311358258999*^9}},
 CellLabel->"Out[97]=",ExpressionUUID->"02a080ff-a65e-43c4-b902-acc9a68e05ff"],

Cell[BoxData[
 RowBox[{"\<\"Error MonteCarlo\"\>", "\[Rule]", 
  "0.00011509968989492999`"}]], "Output",
 CellChangeTimes->{{3.88582106892*^9, 3.885821092959783*^9}, 
   3.885821180511609*^9, {3.885821269851337*^9, 3.885821292598508*^9}, {
   3.8858213436319103`*^9, 3.8858213455982857`*^9}, {3.885821393796534*^9, 
   3.885821418742097*^9}, {3.8858215661142893`*^9, 3.885821592746462*^9}, 
   3.8858217370377693`*^9, 3.885956017813037*^9, {3.88595727874271*^9, 
   3.885957314730135*^9}, {3.885957533433296*^9, 3.885957558767139*^9}, {
   3.885957814809636*^9, 3.885957824350588*^9}, {3.885957873393243*^9, 
   3.885957883157692*^9}, {3.885958767797996*^9, 3.88595877756479*^9}, {
   3.885958958646565*^9, 3.885958967416065*^9}, {3.885959099569586*^9, 
   3.885959184464501*^9}, {3.8859592422193727`*^9, 3.885959361018589*^9}, {
   3.8859594571504183`*^9, 3.885959521524*^9}, {3.885959581355072*^9, 
   3.885959642628861*^9}, {3.885959712081353*^9, 3.885959713554895*^9}, {
   3.885959801284485*^9, 3.885959827272449*^9}, {3.8859598597717133`*^9, 
   3.885959864564445*^9}, {3.88595992297654*^9, 3.8859599270881166`*^9}, {
   3.885960064216976*^9, 3.8859601522818117`*^9}, {3.885960262421507*^9, 
   3.885960282290105*^9}, {3.885960372248829*^9, 3.885960420368408*^9}, {
   3.8859605089406357`*^9, 3.885960524073968*^9}, {3.88596064263603*^9, 
   3.885960785432184*^9}, {3.8859609098043222`*^9, 3.88596095246841*^9}, 
   3.886242849366062*^9, 3.886242927446569*^9, {3.886243045606678*^9, 
   3.886243050912917*^9}, {3.886243184297594*^9, 3.8862431916260366`*^9}, {
   3.8862438489596663`*^9, 3.886243854184699*^9}, {3.886244161761443*^9, 
   3.886244202051*^9}, {3.8862442328527527`*^9, 3.886244239230404*^9}, {
   3.886244487638544*^9, 3.886244506904839*^9}, {3.886244848722135*^9, 
   3.886244852122937*^9}, 3.886245149978559*^9, 3.886245199455751*^9, {
   3.886245243818048*^9, 3.88624524938937*^9}, {3.886245295892758*^9, 
   3.886245302949815*^9}, {3.886245478329138*^9, 3.8862454838921413`*^9}, {
   3.886245576801202*^9, 3.886245579858535*^9}, {3.886245824757681*^9, 
   3.8862458272535467`*^9}, {3.886246090111725*^9, 3.886246091711247*^9}, {
   3.8862487208170567`*^9, 3.8862487232744923`*^9}, {3.886311269972189*^9, 
   3.886311272544612*^9}, {3.886311354834639*^9, 3.88631135826015*^9}},
 CellLabel->"Out[98]=",ExpressionUUID->"ecfe3094-8a3b-40a5-9dcc-cc196a81a73b"],

Cell[BoxData[
 RowBox[{"\<\"Error Adaptive\"\>", "\[Rule]", 
  "2.3386768807572667`*^-6"}]], "Output",
 CellChangeTimes->{{3.88582106892*^9, 3.885821092959783*^9}, 
   3.885821180511609*^9, {3.885821269851337*^9, 3.885821292598508*^9}, {
   3.8858213436319103`*^9, 3.8858213455982857`*^9}, {3.885821393796534*^9, 
   3.885821418742097*^9}, {3.8858215661142893`*^9, 3.885821592746462*^9}, 
   3.8858217370377693`*^9, 3.885956017813037*^9, {3.88595727874271*^9, 
   3.885957314730135*^9}, {3.885957533433296*^9, 3.885957558767139*^9}, {
   3.885957814809636*^9, 3.885957824350588*^9}, {3.885957873393243*^9, 
   3.885957883157692*^9}, {3.885958767797996*^9, 3.88595877756479*^9}, {
   3.885958958646565*^9, 3.885958967416065*^9}, {3.885959099569586*^9, 
   3.885959184464501*^9}, {3.8859592422193727`*^9, 3.885959361018589*^9}, {
   3.8859594571504183`*^9, 3.885959521524*^9}, {3.885959581355072*^9, 
   3.885959642628861*^9}, {3.885959712081353*^9, 3.885959713554895*^9}, {
   3.885959801284485*^9, 3.885959827272449*^9}, {3.8859598597717133`*^9, 
   3.885959864564445*^9}, {3.88595992297654*^9, 3.8859599270881166`*^9}, {
   3.885960064216976*^9, 3.8859601522818117`*^9}, {3.885960262421507*^9, 
   3.885960282290105*^9}, {3.885960372248829*^9, 3.885960420368408*^9}, {
   3.8859605089406357`*^9, 3.885960524073968*^9}, {3.88596064263603*^9, 
   3.885960785432184*^9}, {3.8859609098043222`*^9, 3.88596095246841*^9}, 
   3.886242849366062*^9, 3.886242927446569*^9, {3.886243045606678*^9, 
   3.886243050912917*^9}, {3.886243184297594*^9, 3.8862431916260366`*^9}, {
   3.8862438489596663`*^9, 3.886243854184699*^9}, {3.886244161761443*^9, 
   3.886244202051*^9}, {3.8862442328527527`*^9, 3.886244239230404*^9}, {
   3.886244487638544*^9, 3.886244506904839*^9}, {3.886244848722135*^9, 
   3.886244852122937*^9}, 3.886245149978559*^9, 3.886245199455751*^9, {
   3.886245243818048*^9, 3.88624524938937*^9}, {3.886245295892758*^9, 
   3.886245302949815*^9}, {3.886245478329138*^9, 3.8862454838921413`*^9}, {
   3.886245576801202*^9, 3.886245579858535*^9}, {3.886245824757681*^9, 
   3.8862458272535467`*^9}, {3.886246090111725*^9, 3.886246091711247*^9}, {
   3.8862487208170567`*^9, 3.8862487232744923`*^9}, {3.886311269972189*^9, 
   3.886311272544612*^9}, {3.886311354834639*^9, 3.8863113582611113`*^9}},
 CellLabel->"Out[99]=",ExpressionUUID->"7f721cad-13b4-40d1-99d8-aa01148e8849"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DoubleLayerSingularPart", "[", 
  RowBox[{
   RowBox[{"Mean", "[", "T", "]"}], ",", "T", ",", "\[Kappa]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8859610175177794`*^9, 3.885961018730001*^9}},
 CellLabel->
  "In[6366]:=",ExpressionUUID->"9f9b0563-8b14-44c6-8160-3509f8708926"],

Cell[BoxData["6.2831853071795845`"], "Output",
 CellChangeTimes->{3.8859610191075497`*^9},
 CellLabel->
  "Out[6366]=",ExpressionUUID->"868f90d9-91f5-4a9e-8357-4ec4985e4f64"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DoubleLayerSingularPart", "[", 
  RowBox[{"y", ",", "T", ",", "\[Kappa]"}], "]"}]], "Input",
 CellChangeTimes->{3.88595603615244*^9},
 CellLabel->
  "In[6365]:=",ExpressionUUID->"393d2215-cd33-4280-865d-48e666622e85"],

Cell[BoxData[
 RowBox[{"-", "0.04695898410827699`"}]], "Output",
 CellChangeTimes->{
  3.885956036621583*^9, 3.885956111880808*^9, 3.885956154074771*^9, 
   3.885956386045767*^9, {3.885956469110195*^9, 3.885956470928931*^9}, 
   3.885956501462131*^9, {3.885956997156457*^9, 3.885957007765133*^9}, 
   3.885957180261949*^9, {3.88595781076087*^9, 3.885957828448682*^9}, {
   3.885958706217957*^9, 3.885958718828512*^9}, {3.885958772227326*^9, 
   3.885958808848145*^9}, 3.885958946213336*^9, 3.885959472837605*^9, 
   3.8859595236937523`*^9, {3.885959779052623*^9, 3.8859597860910063`*^9}, 
   3.885960155349118*^9, 3.885960791113529*^9, 3.88596101322787*^9},
 CellLabel->
  "Out[6365]=",ExpressionUUID->"147966f8-5a1e-4e0c-8c95-c1c4109db916"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DoubleLayerSingularPartReference", "[", 
  RowBox[{
   RowBox[{"Mean", "[", "T", "]"}], ",", "T", ",", "\[Kappa]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8859610268293457`*^9, 3.885961028139719*^9}},
 CellLabel->
  "In[6367]:=",ExpressionUUID->"4525ef94-aa68-4c2f-8d0e-67a9e5f86ef3"],

Cell[BoxData["3.295830147610887`"], "Output",
 CellChangeTimes->{3.885961028459289*^9},
 CellLabel->
  "Out[6367]=",ExpressionUUID->"ed8eb784-87c2-4a88-b82a-d033fd9a16be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DoubleLayerSingularPartReference", "[", 
  RowBox[{"y", ",", "T", ",", "\[Kappa]"}], "]"}]], "Input",
 CellLabel->
  "In[6364]:=",ExpressionUUID->"16f3e41a-55b8-410b-b8cf-b99d31c0b32c"],

Cell[BoxData[
 RowBox[{"-", "0.046921007482452703`"}]], "Output",
 CellChangeTimes->{3.885960791882947*^9, 3.885961011991592*^9},
 CellLabel->
  "Out[6364]=",ExpressionUUID->"f3b2d604-afc6-4bfc-a4f8-3030fb91b05b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arrow", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"T", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"Arrow", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"Arrow", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Point", "[", "y", "]"}]}], "\[IndentingNewLine]", "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.88596018232202*^9, 3.8859602246430597`*^9}},
 CellLabel->
  "In[3917]:=",ExpressionUUID->"724edf2d-870d-428f-9da0-83cbb89e15d4"],

Cell[BoxData[
 Graphics3DBox[{
   Arrow3DBox[{{0.179377705342048, -0.6501821663940803, 
    0.25069778141131493`}, {-0.2250614568771816, 
    0.3706123600493325, -0.8531628325510088}}], 
   Arrow3DBox[{{-0.2250614568771816, 
    0.3706123600493325, -0.8531628325510088}, {0.0582273831986333, 
    0.5463238587716259, 0.37755961939323335`}}], 
   Arrow3DBox[{{0.0582273831986333, 0.5463238587716259, 
    0.37755961939323335`}, {0.179377705342048, -0.6501821663940803, 
    0.25069778141131493`}}], 
   Point3DBox[{-0.686537915182944, 
    0.3390001089762862, -0.43991529343782165`}]},
  ImageSize->{338.79057038650046`, 314.5001235463799},
  ImageSizeRaw->Automatic,
  ViewPoint->{1.2038787365120265`, 3.1621743716697654`, 0.03645861940796857},
  ViewVertical->{0.9316091947996678, 0.34809439388429453`, 
   0.10456864305823378`}]], "Output",
 CellChangeTimes->{{3.88596020381853*^9, 3.88596022502431*^9}},
 CellLabel->
  "Out[3917]=",ExpressionUUID->"5f397511-cec2-4fa7-bbf0-8e63e339deaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.885956029889073*^9, {3.885956499160356*^9, 3.8859564996719418`*^9}, 
   3.8859597901594276`*^9},ExpressionUUID->"73eba9b2-c390-499b-839a-\
4201266a3a3e"],

Cell[BoxData[
 RowBox[{"-", "0.17892220033752815`"}]], "Output",
 CellChangeTimes->{
  3.885956030428852*^9, 3.885956112819943*^9, 3.885956151363002*^9, 
   3.885956387040832*^9, 3.8859564676989727`*^9, 3.8859564999922543`*^9, 
   3.885956998296344*^9, 3.885957181034487*^9, {3.885957812237238*^9, 
   3.8859578293198833`*^9}, {3.885958707139209*^9, 3.885958722141107*^9}, {
   3.8859587733232307`*^9, 3.885958779835709*^9}, 3.885958947844821*^9, 
   3.885959471455305*^9, 3.8859595248299017`*^9, {3.885959779950612*^9, 
   3.8859597870446167`*^9}},
 CellLabel->
  "Out[2786]=",ExpressionUUID->"bd9545dc-83cb-44ad-99ff-2239ba75eefb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DoubleLayerSingularPart2", "["}]], "Input",
 CellChangeTimes->{
  3.885956018754915*^9},ExpressionUUID->"b99d71ba-a632-48ae-bcac-\
3a40d7795489"]
},
WindowSize->{1496, 905},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e465f0d9-845c-47f6-8ff9-168788ed19d0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 178, 3, 41, "Input",ExpressionUUID->"8e9841d1-967c-428e-a87e-d627e936d29d"],
Cell[CellGroupData[{
Cell[761, 27, 302, 4, 92, "Input",ExpressionUUID->"251f24c4-12bb-4590-911e-8382ba6eb591"],
Cell[CellGroupData[{
Cell[1088, 35, 366, 6, 77, "Print",ExpressionUUID->"7686ce3d-96e2-4aab-bad0-1b50b555fe32"],
Cell[1457, 43, 182, 4, 30, "Print",ExpressionUUID->"a9796e07-e57a-46a7-9af2-73eb85314eb0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1688, 53, 8541, 241, 1013, "Input",ExpressionUUID->"2189367f-cd50-4131-852a-b3dfd549e6ad"],
Cell[10232, 296, 1749, 35, 54, "Output",ExpressionUUID->"9809f420-e595-4cda-ae22-bd3aef2917f2"],
Cell[11984, 333, 1889, 39, 95, "Output",ExpressionUUID->"7562661d-b354-4464-923d-618b835d1e51"],
Cell[13876, 374, 1557, 26, 75, "Output",ExpressionUUID->"06cde29a-1343-4733-9c3c-f26fc27389c5"],
Cell[15436, 402, 1454, 25, 75, "Output",ExpressionUUID->"d74ec528-dd15-4f7d-97d1-5169f5af2d4f"],
Cell[16893, 429, 1682, 34, 86, "Output",ExpressionUUID->"7566955b-0f7b-458c-a7e6-8f68efddfae5"],
Cell[18578, 465, 2713, 63, 88, "Output",ExpressionUUID->"f2a76f64-d339-41a7-9e4d-21734df9de50"],
Cell[21294, 530, 1839, 36, 78, "Output",ExpressionUUID->"33994fb9-0c1c-45d1-834f-dc376a9b8ad3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23170, 571, 148, 2, 41, "Input",ExpressionUUID->"aa3eb0da-8063-4849-bedb-2d96d2e47e12"],
Cell[23321, 575, 826, 24, 95, "Output",ExpressionUUID->"638c65af-5c3e-4421-af0c-08d452f75ca0"]
}, Open  ]],
Cell[24162, 602, 18521, 431, 2667, "Input",ExpressionUUID->"7bc68429-920c-47eb-b290-6f79911c4484"],
Cell[42686, 1035, 19534, 472, 2100, "Input",ExpressionUUID->"86de4047-5d0a-43fc-aff0-0a0d4aef7b16"],
Cell[62223, 1509, 1118, 29, 142, "Input",ExpressionUUID->"2af51725-0dc7-4e75-bf9c-c6f6d54a11ce"],
Cell[63344, 1540, 153, 3, 41, "Input",ExpressionUUID->"7330966c-6f68-4665-b3e0-b0691d38b3d1"],
Cell[CellGroupData[{
Cell[63522, 1547, 177, 3, 41, "Input",ExpressionUUID->"cd953ece-2056-4812-8f32-9e2344310db3"],
Cell[63702, 1552, 301, 7, 47, "Output",ExpressionUUID->"316817b6-d14e-4f19-a4e7-a48a7442fb6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64040, 1564, 7211, 198, 892, "Input",ExpressionUUID->"ef9c2e6d-bce6-45c4-992f-38264ebd4c69"],
Cell[71254, 1764, 2532, 37, 54, "Output",ExpressionUUID->"a22280cb-976e-4b33-a15b-950c2195b6ff"],
Cell[73789, 1803, 2431, 34, 47, "Output",ExpressionUUID->"7a7017c1-d3c8-455f-b8c0-5edc19110ffc"],
Cell[76223, 1839, 2535, 37, 54, "Output",ExpressionUUID->"0e9c1a49-d861-4602-be41-5bd9d6bb9412"],
Cell[78761, 1878, 2532, 37, 54, "Output",ExpressionUUID->"f29c81e2-44f8-446a-a521-87cc4b8a3ade"],
Cell[81296, 1917, 2323, 31, 47, "Output",ExpressionUUID->"e0d2111b-9fda-4021-a338-634c82a9756a"],
Cell[83622, 1950, 2377, 33, 49, "Output",ExpressionUUID->"02a080ff-a65e-43c4-b902-acc9a68e05ff"],
Cell[86002, 1985, 2378, 33, 47, "Output",ExpressionUUID->"ecfe3094-8a3b-40a5-9dcc-cc196a81a73b"],
Cell[88383, 2020, 2379, 33, 49, "Output",ExpressionUUID->"7f721cad-13b4-40d1-99d8-aa01148e8849"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90799, 2058, 303, 7, 41, "Input",ExpressionUUID->"9f9b0563-8b14-44c6-8160-3509f8708926"],
Cell[91105, 2067, 174, 3, 47, "Output",ExpressionUUID->"868f90d9-91f5-4a9e-8357-4ec4985e4f64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91316, 2075, 241, 5, 41, "Input",ExpressionUUID->"393d2215-cd33-4280-865d-48e666622e85"],
Cell[91560, 2082, 741, 12, 47, "Output",ExpressionUUID->"147966f8-5a1e-4e0c-8c95-c1c4109db916"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92338, 2099, 312, 7, 41, "Input",ExpressionUUID->"4525ef94-aa68-4c2f-8d0e-67a9e5f86ef3"],
Cell[92653, 2108, 171, 3, 47, "Output",ExpressionUUID->"ed8eb784-87c2-4a88-b82a-d033fd9a16be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92861, 2116, 209, 4, 41, "Input",ExpressionUUID->"16f3e41a-55b8-410b-b8cf-b99d31c0b32c"],
Cell[93073, 2122, 213, 4, 47, "Output",ExpressionUUID->"f3b2d604-afc6-4bfc-a4f8-3030fb91b05b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93323, 2131, 1025, 30, 117, "Input",ExpressionUUID->"724edf2d-870d-428f-9da0-83cbb89e15d4"],
Cell[94351, 2163, 990, 20, 498, "Output",ExpressionUUID->"5f397511-cec2-4fa7-bbf0-8e63e339deaa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95378, 2188, 204, 4, 41, "Input",ExpressionUUID->"73eba9b2-c390-499b-839a-4201266a3a3e"],
Cell[95585, 2194, 633, 11, 47, "Output",ExpressionUUID->"bd9545dc-83cb-44ad-99ff-2239ba75eefb"]
}, Open  ]],
Cell[96233, 2208, 169, 4, 41, "Input",ExpressionUUID->"b99d71ba-a632-48ae-bcac-3a40d7795489"]
}
]
*)


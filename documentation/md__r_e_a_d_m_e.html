<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: BÄMM!</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">BÄMM!</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a></p>
<p>BÄMM! - a brute force approach for the boundary element method</p>
<p>Operator application: In the following we use the following typename aliases: C_ext: user defined complex type R_ext: user defined real type I_ext: user defined int type</p>
<p>Boundary operators: For single uses of the operator, you apply the boundary operators normally on a PL-function by calling</p>
<p>ApplyBoundaryOperators_PL(
        const C_ext alpha, cptr&lt;C_ext&gt; B_in,  const I_ext ldB_in,
        const C_ext beta,  mptr&lt;C_ext&gt; C_out, const I_ext ldC_out,
        const R_ext * kappa_list,
        const C_ext * coeff_list,
        const I_ext wave_count_,
        const I_ext wave_chunk_size_
    )</p>
<p>Here, kappa_list has length wave_chunk_count = wave_count_/wave_chunk_size and coeff list is a 2D-array of size wave_chunk_count x 4 (where the coulumns represent the factors of M,SL,DL,adjDL). M denotes the PL mass matrix. This function loads the latter parameters into global scope, compiles the kernel, applies the resulting operator to B_in and copies the result into C_out. Note that this is the weak form, hence for the strong form one has to apply M^(-1) to the result.</p>
<p>(Only OpenCL) For multiple uses of the SAME operator (as for instance in a linear solver) there is another way to apply the kernel:</p>
<p>kernel_list LoadBoundaryOperators_PL(
        const R_ext * kappa_,
        const C_ext * c_,
        const I_ext wave_count_,
        const I_ext wave_chunk_size_  \ilinebr&lt;br&gt;
    )</p>
<p>Loads the kernel, compiles, uploads the constant buffers and returns a struct with the buffer information.</p>
<p>Then,</p>
<p>void ApplyBoundaryOperators_PL(
        const C_ext alpha, cptr&lt;C_ext&gt; B_in,  const I_ext ldB_in,
        const C_ext beta,  mptr&lt;C_ext&gt; C_out, const I_ext ldC_out
    )</p>
<p>is the reduced application of the boundary operators to this fixed environment. IMPORTANT: after being finished with the kernel one also has to "destroy it to release the device buffers by calling:

    void UnoadBoundaryOperators_PL(
        kernel_list* list
    )


Boundary to Farfield map:
@iverbatim 
The application works quite exactly as for the boundary operators:

ApplyFarFieldOperators_PL(
    const C_ext alpha, cptr&lt;C_ext&gt; B_in,  const I_ext ldB_in,
    const C_ext beta,  mptr&lt;C_ext&gt; C_out, const I_ext ldC_out,
    const R_ext * kappa_list,
    const C_ext * coeff_list,
    const I_ext wave_count_,
    const I_ext wave_chunk_size_
)

Note that as there are only single- and double layer far field operators, the coefficients in the "mass" and the "adjoint DL" rows of coeff_list will be ignored. </p>
<p>Wave function assembly: </p><pre class="fragment">For the (CPU) assembly of the standard incident waves with entries (c[1] + i*k*c[2]*&lt;d,n&gt;)*e^(i*k*&lt;d,x&gt;) one uses

template&lt;typename R_ext, typename C_ext, typename I_ext&gt;
void CreateIncidentWave_PL(
    const C_ext alpha, cptr&lt;R_ext&gt; incident_directions,  const I_ext inc_count,
    const C_ext beta,  mptr&lt;C_ext&gt; C_out, const I_ext ldC_out,
    const R_ext * kappa_list,
    const C_ext * coeff_list,
    const I_ext wave_count_,
    const I_ext wave_chunk_size_
)

where inc_count = wave chunk_count is necessary and excess wave vectors will be ignored.

To assemble a Herglotz wave function with kernel B_in via the GPU one needs to call

template&lt;typename R_ext, typename C_ext, typename I_ext&gt;
void CreateHerglotzWave_PL(
    const C_ext alpha, cptr&lt;C_ext&gt; B_in,  const I_ext ldB_in,
    const C_ext beta,  mptr&lt;C_ext&gt; C_out, const I_ext ldC_out,
    const R_ext * kappa_list,
    const C_ext * coeff_list,
    const I_ext wave_count_,
    const I_ext wave_chunk_size_
)

coeff[:][0] and coeff[:][3] will again be ignored for all wave assemblies.
</pre><p>Far Field Operators: The far field operator, its directional derivative and the $L^2$-adjoint of its directional derivative are implemented in FarField.hpp. The routine GaussNewton calculates (M + DF*DF)^{-1} for M to be a scaled metric operator. Also there are executables in the "main" folder for the direct application from "ouside". They read their data from data.txt (which contains data as specified in WriteFiles), simplices.bin, meas_direction.bin and coords.bin and the differential operators read their input from B.bin. The result is again written to B.bin. GaussNewtonStep calculates (regpar*M + DF*DF)^{-1}(-1)(DF*(res) + regpar * DE) for the Tangent-Point-Energy and a proper metric. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
